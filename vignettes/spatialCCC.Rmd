---
title: "spatialCCC"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{spatialCCC}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message = FALSE}
library(spatialCCC)
```


```{r}
library(dplyr)
library(ggplot2)
library(patchwork)
```


  * Then, load built-in LR database.
```{r LRdb-loading}
set.seed(100)

LRdb_m <- 
  get_LRdb("mouse", n_samples = 100)

LRdb_full <-
  get_LRdb("mouse")

LRdb <- LRdb_m
#LRdb <- LRdb_full
```


  * Load an example Visium spatial transcriptomic data
```{r visium-data-loading}
data_dir <- file.path("example")

spe_brain <-
  SpatialExperiment::read10xVisium(samples = data_dir,
                                   type = "HDF5",
                                   data = "filtered")

# Log-Normalize
spe_brain <- scater::logNormCounts(spe_brain)
```
