[{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"article-1","text":"basic example shows basic workflow package:","code":""},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"load-necessary-packages","dir":"Articles","previous_headings":"","what":"Load necessary packages","title":"article-1","text":"first load R packages required example .","code":"library(patchwork) library(ggtree)  # spatialCCC package library(spatialCCC) #> Warning: replacing previous import 'S4Arrays::makeNindexFromArrayViewport' by #> 'DelayedArray::makeNindexFromArrayViewport' when loading 'SummarizedExperiment' #> Warning: replacing previous import 'S4Arrays::makeNindexFromArrayViewport' by #> 'DelayedArray::makeNindexFromArrayViewport' when loading 'HDF5Array'"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"load-built-in-lrdb","dir":"Articles","previous_headings":"Ligand-Receptor Database","what":"Load built-in LRdb","title":"article-1","text":"LRdb downloaded CellTalkDB: [http://tcm.zju.edu.cn/celltalkdb/download.php]. can see detail : also created getter functions, get_LRdb() get_LRdb_small(), retrieve database.","code":"?LRdb_human ?LRdb_mouse set.seed(100)  LRdb_m <-    get_LRdb(\"mouse\", n_samples = 100)  LRdb_m %>%    dplyr::arrange(ligand_gene_symbol, receptor_gene_symbol) #> # A tibble: 100 × 10 #>    LR    ligand_gene_symbol receptor_gene_symbol ligand_gene_id receptor_gene_id #>    <chr> <chr>              <chr>                         <dbl>            <dbl> #>  1 Adam… Adam10             Notch1                        11487            18128 #>  2 Adam… Adam12             Epha1                         11489            13835 #>  3 Adam… Adam17             Aplp2                         11491            11804 #>  4 Adam… Adam2              Itgb7                         11495            16421 #>  5 Adcy… Adcyap1            Adcyap1r1                     11516            11517 #>  6 Adcy… Adcyap1            Ramp3                         11516            56089 #>  7 Adip… Adipoq             Adipor1                       11450            72674 #>  8 Adm2… Adm2               Calcrl                       223780            54598 #>  9 Apoe… Apoe               Ldlr                          11816            16835 #> 10 Apoe… Apoe               Trem2                         11816            83433 #> # ℹ 90 more rows #> # ℹ 5 more variables: ligand_ensembl_protein_id <chr>, #> #   receptor_ensembl_protein_id <chr>, ligand_ensembl_gene_id <chr>, #> #   receptor_ensembl_gene_id <chr>, evidence <chr>"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"load-visium-spatial-transcriptomic-data","dir":"Articles","previous_headings":"","what":"Load Visium spatial transcriptomic data","title":"article-1","text":"","code":"data_dir <- spatialCCC_example(\"example\")  spe_brain <-   SpatialExperiment::read10xVisium(samples = data_dir,                                    type = \"HDF5\",                                    data = \"filtered\")  # to keep track of cell IDs # spe_brain[[\"cell_id\"]] <- colnames(spe_brain)  # Log-Normalize spe_brain <- scater::logNormCounts(spe_brain)"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"cell-cluster-data","dir":"Articles","previous_headings":"","what":"Cell cluster data","title":"article-1","text":"Now, let’s read cell cluster data, obtained using GraphST.","code":"cell_clusters <-   read.csv(file.path(data_dir, \"outs\", \"graphST.csv\"), row.names = 1)  # Make sure the rows of cell_clusters are in the same order of spe_brain. cell_clusters <- cell_clusters[colnames(spe_brain), ]  cluster_ids <- colnames(cell_clusters) cluster_ids <- cluster_ids[grep(\"mclust_\", cluster_ids)]  for (cid in cluster_ids) {   spe_brain[[cid]] <- factor(cell_clusters[[cid]]) } plot_spatial_feature(spe = spe_brain, feature = \"mclust_8\")"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"compute-cell-cell-communications-over-ligand-receptor-pairs","dir":"Articles","previous_headings":"","what":"Compute Cell-Cell Communications over ligand-receptor pairs","title":"article-1","text":"","code":"tictoc::tic()  ccc_graph_list <-   compute_spatial_ccc_graph_list(spe = spe_brain,                                  assay_name = \"logcounts\",                                  LRdb = LRdb_m)  tictoc::toc() #> 694.279 sec elapsed ccc_graph_list <-   ccc_graph_list %>%   purrr::map(function(ccog) {     ccog %>%       add_node_annot_to_edges(c(\"mclust_8\", \"mclust_9\", \"mclust_10\"))   }) ccc_tbl <-   ccc_graph_list %>%   purrr::map(function(ccog) {     ccog %>%       tidygraph::activate(\"edges\") %>%       as_tibble()   }) %>%   dplyr::bind_rows(.id = \"LR\")"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"summarize-cell-cell-communication-between-cell-clusters","dir":"Articles","previous_headings":"Compute Cell-Cell Communications over ligand-receptor pairs","what":"Summarize cell-cell communication between cell clusters","title":"article-1","text":"","code":"ccc_tbl_between_clusters <-   ccc_tbl %>%   dplyr::group_by(mclust_8_src, mclust_8_dst, LR) %>%   dplyr::summarise(n = dplyr::n(),                    LRscore.sum = sum(LRscore),                    .groups = \"drop\")  ccc_tbl_between_clusters %>%   dplyr::arrange(desc(n)) #> # A tibble: 1,327 × 5 #>    mclust_8_src mclust_8_dst LR                    n LRscore.sum #>    <fct>        <fct>        <chr>             <int>       <dbl> #>  1 3            3            App_Lrp1           4480       3576. #>  2 3            3            Nlgn2_Nrxn1        3592       2585. #>  3 3            3            Ncam1_Fgfr1        3093       2167. #>  4 3            3            S100a1_Ryr2        2349       1592. #>  5 2            2            App_Lrp1           2136       1710. #>  6 3            3            Apoe_Ldlr          1953       1487. #>  7 2            2            Nlgn2_Nrxn1        1840       1386. #>  8 1            1            App_Lrp1           1742       1406. #>  9 3            3            Apoe_Trem2         1720       1322. #> 10 3            3            Adcyap1_Adcyap1r1  1687       1131. #> # ℹ 1,317 more rows ccc_tbl_between_clusters %>%   dplyr::filter(mclust_8_dst != mclust_8_src) %>%   dplyr::arrange(desc(n)) #> # A tibble: 1,004 × 5 #>    mclust_8_src mclust_8_dst LR                n LRscore.sum #>    <fct>        <fct>        <chr>         <int>       <dbl> #>  1 3            5            App_Lrp1        304        241. #>  2 5            3            App_Lrp1        300        238. #>  3 5            3            Nlgn2_Nrxn1     255        184. #>  4 3            5            S100a1_Ryr2     224        161. #>  5 8            3            App_Lrp1        212        171. #>  6 3            5            Ncam1_Fgfr1     208        145. #>  7 3            8            App_Lrp1        199        157. #>  8 3            5            Nlgn2_Nrxn1     195        141. #>  9 5            3            Ncam1_Fgfr1     165        116. #> 10 3            5            Calm2_Cacna1c   163        122. #> # ℹ 994 more rows"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"convert-ccc-table-to-ccc-graph","dir":"Articles","previous_headings":"Compute Cell-Cell Communications over ligand-receptor pairs","what":"Convert CCC table to CCC graph","title":"article-1","text":"summarize_ccc_graph_metrics() summarize graph metrics LR pair. summarize_ccc_graph_metrics(…, level = “group”) summarizes metrics subgraph (group) CCC graph (LR)","code":"tictoc::tic()  ccc_graph_metrics_summary_df <-   summarize_ccc_graph_metrics(ccc_graph_list)  tictoc::toc() #> 0.237 sec elapsed ccc_graph_metrics_summary_df %>%   dplyr::arrange(graph_component_count) #> # A tibble: 41 × 12 #>    LR        graph_n_nodes graph_n_edges graph_component_count graph_motif_count #>    <chr>             <int>         <dbl>                 <dbl>             <int> #>  1 App_Lrp1           2700         17430                     3             27811 #>  2 Ncam1_Fg…          2549          9640                     3             18340 #>  3 Nlgn2_Nr…          2675         14289                     3             25062 #>  4 S100a1_R…          2591         10689                     5             20094 #>  5 Calm2_Ca…          2461          8105                     6             16288 #>  6 Apoe_Tre…          2560          6937                     8             14484 #>  7 Apoe_Ldlr          2295          5608                    26             11724 #>  8 Slit1_Ro…          1651          4373                    41              7866 #>  9 Calm2_My…          1967          4247                    42              8830 #> 10 Adcyap1_…          1642          4172                    43              7801 #> # ℹ 31 more rows #> # ℹ 7 more variables: graph_diameter <dbl>, graph_un_diameter <dbl>, #> #   graph_mean_dist <dbl>, graph_circuit_rank <dbl>, graph_reciprocity <dbl>, #> #   graph_clique_num <int>, graph_clique_count <int> tictoc::tic()  ccc_graph_group_metrics_summary_df <-   summarize_ccc_graph_metrics(ccc_graph_list, level = \"group\")  tictoc::toc() #> 0.305 sec elapsed ccc_graph_group_metrics_summary_df  #> # A tibble: 2,877 × 12 #>    LR         group group_n_nodes group_n_edges group_adhesion group_motif_count #>    <chr>      <int>         <int>         <dbl>          <dbl>             <int> #>  1 Rspo3_Lgr6    38             2             1              0                 0 #>  2 Rspo3_Lgr6    13             3             3              0                 1 #>  3 Rspo3_Lgr6    39             2             1              0                 0 #>  4 Rspo3_Lgr6    14             3             2              0                 1 #>  5 Rspo3_Lgr6     5             4             3              0                 3 #>  6 Rspo3_Lgr6     6             4             4              0                 3 #>  7 Rspo3_Lgr6    75             1             1              0                 0 #>  8 Rspo3_Lgr6    40             2             1              0                 0 #>  9 Rspo3_Lgr6    41             2             1              0                 0 #> 10 Rspo3_Lgr6    15             3             3              0                 1 #> # ℹ 2,867 more rows #> # ℹ 6 more variables: group_diameter <dbl>, group_un_diameter <dbl>, #> #   group_mean_dist <dbl>, group_girth <dbl>, group_circuit_rank <dbl>, #> #   group_reciprocity <dbl>"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"article-1","text":"","code":"LR_of_interest <- \"Pdgfb_Pdgfra\" ccc_graph_list[[LR_of_interest]] %>%   tidygraph::activate(edges) %>%   tibble::as_tibble() #> # A tibble: 2,406 × 40 #>     from    to src    dst       d norm.d ligand receptor LRscore weight WLRscore #>    <int> <int> <chr>  <chr> <dbl>  <dbl> <chr>  <chr>      <dbl>  <dbl>    <dbl> #>  1     1     1 AAACA… AAAC…    0    0    Pdgfb  Pdgfra     0.621  1        0.621 #>  2     1   920 AAACA… AGAG…  138.   1.01 Pdgfb  Pdgfra     0.649  0.980    0.636 #>  3     1   921 AAACA… GGCA…  138.   1.01 Pdgfb  Pdgfra     0.684  0.987    0.675 #>  4     1   896 AAACA… TTCT…  138.   1.01 Pdgfb  Pdgfra     0.629  0.980    0.616 #>  5     2   922 AAACA… TCAC…  138.   1.01 Pdgfb  Pdgfra     0.599  0.980    0.587 #>  6     3     3 AAACC… AAAC…    0    0    Pdgfb  Pdgfra     0.541  1        0.541 #>  7     3   923 AAACC… CGCT…  138    1.01 Pdgfb  Pdgfra     0.631  0.986    0.622 #>  8     3   924 AAACC… TTGG…  138.   1.01 Pdgfb  Pdgfra     0.509  0.980    0.498 #>  9     4     4 AAACG… AAAC…    0    0    Pdgfb  Pdgfra     0.641  1        0.641 #> 10     4    50 AAACG… AAGA…  138    1.01 Pdgfb  Pdgfra     0.670  0.986    0.660 #> # ℹ 2,396 more rows #> # ℹ 29 more variables: LRscore_perc_rank <dbl>, graph_n_nodes <int>, #> #   graph_n_edges <dbl>, graph_component_count <dbl>, graph_motif_count <int>, #> #   graph_diameter <dbl>, graph_un_diameter <dbl>, graph_mean_dist <dbl>, #> #   graph_circuit_rank <dbl>, graph_reciprocity <dbl>, graph_clique_num <int>, #> #   graph_clique_count <int>, group <int>, group_n_nodes <int>, #> #   group_n_edges <dbl>, group_adhesion <dbl>, group_motif_count <int>, …"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"spatial-ccc-graph-plot-with-tissue-image","dir":"Articles","previous_headings":"Visualization","what":"spatial CCC graph plot with tissue image","title":"article-1","text":"","code":"gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     tissue_img = SpatialExperiment::imgRaster(spe_brain),     node_color = \"mclust_8\",     node_size = 1,     node_alpha = 0.5,     edge_color = \"group\",     # clip = TRUE,     which_on_top = \"edge\"   )  gp_spccc_0 <-   plot_spatial_feature(spe = spe_brain,                        feature = \"mclust_8\") wrap_plots(gp_spccc, gp_spccc_0, ncol = 2) ccc_graph_temp <-   ccc_graph_list[[LR_of_interest]] %>%   tidygraph::activate(\"edges\") %>%   tidygraph::filter(mclust_8_src != mclust_8_dst) %>%   tidy_up_ccc_graph()  cells_of_interest <-   ccc_graph_temp %>%   tidygraph::activate(\"nodes\") %>%   dplyr::pull(\"name\") gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_temp,     tissue_img = SpatialExperiment::imgRaster(spe_brain),     node_color = \"n.inflow\",     node_size = 1.25,     node_alpha = 1,     edge_color = \"group\",     show_arrow = TRUE,     # clip = TRUE,     which_on_top = \"node\"   )  gp_spccc_0 <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     tissue_img = SpatialExperiment::imgRaster(spe_brain),     image_alpha = 0,     cells_of_interest = cells_of_interest,     edges_expanded_to_group = FALSE,     node_color = \"mclust_8\",     node_size = 1.25,     node_alpha = 0.5,     edge_color = \"group\",     show_arrow = TRUE,     # clip = TRUE,     which_on_top = \"node\"   )  gp_spccc_1 <-   plot_spatial_feature(spe = spe_brain,                        feature = \"mclust_8\",                        cells_of_interest = cells_of_interest) wrap_plots(gp_spccc, gp_spccc_1, ncol = 2) gp_spccc_0"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"spatial-ccc-graph-plot-without-tissue-image","dir":"Articles","previous_headings":"Visualization","what":"spatial CCC graph plot without tissue image","title":"article-1","text":"case, graph layout can “spatial” keeps original spatial locations, graph layout algorithm supported igraph package.  uses “auto” layout (“kk” spring layout).  case, “stress” layout.","code":"gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     graph_layout = \"spatial\",     node_color =  \"mclust_8\",     node_size = 1,     edge_color = \"group_diameter\",     clip = TRUE,     # ghost_img = TRUE,     which_on_top = \"edge\"   )  gp_spccc_0 <-   plot_spatial_ccc_graph(     ccc_graph =       ccc_graph_list[[LR_of_interest]],     graph_layout = \"spatial\",     node_color = \"mclust_8\",     node_size = 1,     edge_color = \"group_diameter\",     clip = TRUE,     # ghost_img = TRUE,     which_on_top = \"node\"   ) wrap_plots(gp_spccc, gp_spccc_0, ncol = 2, guides = \"collect\") plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[LR_of_interest]],                        # tissue_img = SpatialExperiment::imgRaster(spe_brain),                        node_color = \"group\",                        node_size = 0.1,                        edge_color = \"group_diameter\",                        edge_width = 0.1,                        which_on_top = \"edge\") plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[LR_of_interest]],                        # tissue_img = SpatialExperiment::imgRaster(spe_brain),                        graph_layout = \"stress\",                        node_color = \"group\",                        edge_color = \"group_diameter\",                        edge_width = 0.25,                        which_on_top = \"edge\")"},{"path":"https://skimlab.github.io/spatialCCC/articles/article-1.html","id":"cell-overlap-distance","dir":"Articles","previous_headings":"","what":"Cell-overlap distance","title":"article-1","text":"","code":"tictoc::tic()  cell_overlap_dist <-   dist_cell_overlap_ccc_tbl(ccc_tbl)  tictoc::toc() #> 0.878 sec elapsed tictoc::tic()  cell_overlap_lf <-   lf_cell_overlap_ccc_tbl(ccc_tbl)  tictoc::toc() #> 1.229 sec elapsed tictoc::tic()  LRs_high_cell_overlap <-   cell_overlap_lf %>%    dplyr::filter(d < 1) %>%   dplyr::select(lr1, lr2) %>%   unlist() %>% unique()  tictoc::toc() #> 0.011 sec elapsed tictoc::tic()  high_cell_overlap_dist <-   cell_overlap_dist[LRs_high_cell_overlap, LRs_high_cell_overlap]  tictoc::toc() #> 0.003 sec elapsed tictoc::tic()  high_cell_overlap_dist2 <-   cell_overlap_lf %>%   dplyr::filter(d < 1) %>%   dplyr::select(lr1, lr2, d) %>%   lf_to_dist()  tictoc::toc() #> 0.031 sec elapsed LR_ccc_summary_tbl <-   ccc_tbl %>%    dplyr::pull(LR) %>%   table() %>%   tibble::as_tibble() %>%   dplyr::rename(\"LR\" = \".\") %>%   dplyr::arrange(desc(n)) %>%   dplyr::left_join(     ccc_tbl %>%        dplyr::select(LR, ligand, receptor) %>%       dplyr::distinct(),     by = \"LR\"   ) hclus.res <- fastcluster::hclust(as.dist(high_cell_overlap_dist),                                  method = \"complete\") ape::as.phylo(hclus.res) %>%   ggtree(layout=\"dendrogram\") %<+% LR_ccc_summary_tbl +   aes(color=receptor) +   theme(legend.position = \"none\") +   geom_tippoint(aes(size=n), alpha=0.5) +   geom_tiplab(size=2, offset=-0.15) +   xlim_tree(3) ape::as.phylo(hclus.res) %>%   ggtree(layout = \"circular\") %<+% LR_ccc_summary_tbl +   aes(color=receptor) +   # aes(color=ligand) +   theme(legend.position = \"none\") +   geom_tippoint(aes(size=n), alpha=0.5) +   geom_tiplab(size=2, offset=0.05)"},{"path":"https://skimlab.github.io/spatialCCC/articles/spatialCCC.html","id":"cell-cell-communication-analysis","dir":"Articles","previous_headings":"","what":"Cell-cell communication analysis","title":"spatialCCC","text":"Compute Cell-Cell Communications ligand-receptor pairs Summarize spatial CCC graphs LR  CCC graph summary table ligands receptors multiple occurrences Spatial CCC graph ligand multiple occurences","code":"#future::plan(future::multisession, workers = 8)  ccc_graph_list <-   compute_spatial_ccc_graph_list(spe = spe_brain,                                  assay_name = \"logcounts\",                                  LRdb = LRdb)  #future::plan(future::sequential) ccc_graph_summary_tbl <-   ccc_graph_list %>%   to_LR_summary_tbl() %>%   arrange(desc(perc_rank))  ccc_graph_summary_tbl #> # A tibble: 41 × 20 #>    LR          L     R         n LRscore n_perc_rank LRscore_perc_rank perc_rank #>    <chr>       <chr> <chr> <int>   <dbl>       <dbl>             <dbl>     <dbl> #>  1 App_Lrp1    App   Lrp1  17430   0.806       1                 1         1     #>  2 Apoe_Trem2  Apoe  Trem2  6937   0.767       0.875             0.975     0.924 #>  3 Nlgn2_Nrxn1 Nlgn2 Nrxn1 14289   0.741       0.975             0.875     0.924 #>  4 Calm2_Cacn… Calm2 Cacn…  8105   0.760       0.9               0.925     0.912 #>  5 Apoe_Ldlr   Apoe  Ldlr   5608   0.764       0.85              0.95      0.899 #>  6 S100a1_Ryr2 S100… Ryr2  10689   0.690       0.95              0.825     0.885 #>  7 Ncam1_Fgfr1 Ncam1 Fgfr1  9640   0.688       0.925             0.8       0.860 #>  8 Calm2_Mylk  Calm2 Mylk   4247   0.750       0.8               0.9       0.849 #>  9 Adcyap1_Ad… Adcy… Adcy…  4172   0.644       0.775             0.75      0.762 #> 10 Adam17_Apl… Adam… Aplp2  3338   0.692       0.675             0.85      0.757 #> # ℹ 31 more rows #> # ℹ 12 more variables: perc_group <chr>, graph_n_nodes <int>, #> #   graph_n_edges <dbl>, graph_component_count <dbl>, graph_motif_count <int>, #> #   graph_diameter <dbl>, graph_un_diameter <dbl>, graph_mean_dist <dbl>, #> #   graph_circuit_rank <dbl>, graph_reciprocity <dbl>, graph_clique_num <int>, #> #   graph_clique_count <int> top_LR <-    ccc_graph_summary_tbl %>%   pull(LR) %>%   head(n = 1)  bottom_LR <-   ccc_graph_summary_tbl %>%   pull(LR) %>%   tail(n = 1) gp_ccc_graph_top_LR <-   plot_spatial_ccc_graph(ccc_graph_list[[top_LR]],                          graph_layout = \"spatial\",                          edge_color = \"LRscore\",                          node_color = \"LRscore.sum.src\") +   ggtitle(top_LR)  gp_ccc_graph_bottom_LR <-   plot_spatial_ccc_graph(ccc_graph_list[[bottom_LR]],                          graph_layout = \"spatial\",                          edge_color = \"LRscore\",                          node_color = \"LRscore.sum.src\") +   ggtitle(bottom_LR) wrap_plots(gp_ccc_graph_top_LR, gp_ccc_graph_bottom_LR) L_high_freq <-   ccc_graph_summary_tbl %>%   group_by(L) %>%   summarise(n = n(), .groups = \"drop\") %>%   dplyr::filter(n > 1) %>%   dplyr::arrange(desc(n)) %>%    pull(L)  L_high_freq #> [1] \"Adcyap1\" \"Apoe\"    \"Calm2\"   \"S100a1\"  \"Sema5a\" R_high_freq <-   ccc_graph_summary_tbl %>%   group_by(R) %>%   summarise(n = n(), .groups = \"drop\") %>%   dplyr::filter(n > 1) %>%   dplyr::arrange(desc(n)) %>%    pull(R)  R_high_freq #> [1] \"Fzd7\"  \"Robo3\" ccc_graph_summary_tbl %>%   dplyr::filter(L %in% L_high_freq | R %in% R_high_freq) #> # A tibble: 15 × 20 #>    LR          L     R         n LRscore n_perc_rank LRscore_perc_rank perc_rank #>    <chr>       <chr> <chr> <int>   <dbl>       <dbl>             <dbl>     <dbl> #>  1 Apoe_Trem2  Apoe  Trem2  6937   0.767       0.875             0.975    0.924  #>  2 Calm2_Cacn… Calm2 Cacn…  8105   0.760       0.9               0.925    0.912  #>  3 Apoe_Ldlr   Apoe  Ldlr   5608   0.764       0.85              0.95     0.899  #>  4 S100a1_Ryr2 S100… Ryr2  10689   0.690       0.95              0.825    0.885  #>  5 Calm2_Mylk  Calm2 Mylk   4247   0.750       0.8               0.9      0.849  #>  6 Adcyap1_Ad… Adcy… Adcy…  4172   0.644       0.775             0.75     0.762  #>  7 Sema5a_Plx… Sema… Plxn…  3869   0.609       0.75              0.55     0.642  #>  8 Sema5a_Plx… Sema… Plxn…  2054   0.622       0.575             0.625    0.599  #>  9 S100a1_Ryr1 S100… Ryr1   1060   0.637       0.45              0.675    0.551  #> 10 Adcyap1_Ra… Adcy… Ramp3  2039   0.608       0.55              0.525    0.537  #> 11 Wnt7b_Fzd7  Wnt7b Fzd7    528   0.583       0.25              0.2      0.224  #> 12 Slit2_Robo3 Slit2 Robo3   687   0.578       0.325             0.125    0.202  #> 13 Wnt9a_Fzd7  Wnt9a Fzd7    193   0.566       0.075             0.025    0.0433 #> 14 Slit3_Robo3 Slit3 Robo3   263   0.557       0.15              0        0      #> 15 Wnt3_Fzd7   Wnt3  Fzd7    144   0.588       0                 0.325    0      #> # ℹ 12 more variables: perc_group <chr>, graph_n_nodes <int>, #> #   graph_n_edges <dbl>, graph_component_count <dbl>, graph_motif_count <int>, #> #   graph_diameter <dbl>, graph_un_diameter <dbl>, graph_mean_dist <dbl>, #> #   graph_circuit_rank <dbl>, graph_reciprocity <dbl>, graph_clique_num <int>, #> #   graph_clique_count <int> high_L_LR_list <-    ccc_graph_summary_tbl %>%    dplyr::filter(L == L_high_freq[1]) %>%    pull(LR) %>%   setNames(nm = .)  gp_list <-   high_L_LR_list %>%   purrr::map(function(lr) {     plot_spatial_ccc_graph(       ccc_graph_list[[lr]],       graph_layout = \"spatial\",       edge_color = \"LRscore\",       clip = FALSE     ) +       ggtitle(lr)   }) wrap_plots(gp_list) high_R_LR_list <-    ccc_graph_summary_tbl %>%    dplyr::filter(R == R_high_freq[1]) %>%    pull(LR) %>%   setNames(nm = .)  gp_list <-   high_R_LR_list %>%   purrr::map(function(lr) {     plot_spatial_ccc_graph(       ccc_graph_list[[lr]],       graph_layout = \"spatial\",       edge_color = \"LRscore\",       clip = FALSE     ) +       ggtitle(lr)   }) wrap_plots(gp_list) ccog_diff_1 <-   ccc_graph_diff(ccc_graph_list[[high_L_LR_list[1]]],                  ccc_graph_list[[high_L_LR_list[2]]])  ccog_diff_2 <-   ccc_graph_diff(ccc_graph_list[[high_L_LR_list[2]]],                  ccc_graph_list[[high_L_LR_list[1]]]) ccog_union <-   ccc_graph_union(ccc_graph_list[[high_L_LR_list[1]]],                   ccc_graph_list[[high_L_LR_list[2]]])  ccog_intersect <-   ccc_graph_intersect(ccc_graph_list[[high_L_LR_list[1]]],                       ccc_graph_list[[high_L_LR_list[2]]]) gp_list <-   list(ccog_diff_1, ccog_diff_2) %>%   purrr::map(function(ccog) {     plot_spatial_ccc_graph(ccog,                            graph_layout = \"spatial\")   }) wrap_plots(gp_list) gp_list <-   list(ccog_diff_1, ccog_diff_2) %>%   purrr::map(function(ccog) {     plot_spatial_ccc_graph(ccog,                            graph_layout = \"spatial\")   }) wrap_plots(gp_list) gp_list <-   list(intersect = ccog_intersect, union = ccog_union) %>%   purrr::map(function(ccog) {     plot_spatial_ccc_graph(ccog,                            graph_layout = \"spatial\")   }) wrap_plots(gp_list) gp_list <-   list(ccog_diff_1, ccog_diff_2) %>%   purrr::map(function(ccog) {     plot_spatial_ccc_graph(ccog,                            graph_layout = \"spatial\",                            tissue_img = SpatialExperiment::imgRaster(spe_brain))   }) wrap_plots(gp_list) gp_list <-   list(intersect = ccog_intersect, union = ccog_union) %>%   purrr::map(function(ccog) {     plot_spatial_ccc_graph(ccog,                            graph_layout = \"spatial\",                            tissue_img = SpatialExperiment::imgRaster(spe_brain))   }) wrap_plots(gp_list) ccog_flattened <-   flatten_ccc_graph_list(ccc_graph_ls = ccc_graph_list) plot_spatial_ccc_graph(   ccog_flattened,   tissue_img = SpatialExperiment::imgRaster(spe_brain),   graph_layout = \"spatial\",   node_color = \"LRscore.sum.src\",   edge_color = \"LRscore\",   # node_size = 1.6,   node_alpha = 0,   which_on_top = \"edge\" )"},{"path":"https://skimlab.github.io/spatialCCC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Seungchan Kim. Author, maintainer.","code":""},{"path":"https://skimlab.github.io/spatialCCC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kim S (2023). spatialCCC: Spatial Transcriptomic cell-cell communication analysis. https://github.com/dolchan/spatialCCC, https://skimlab.github.io/spatialCCC/.","code":"@Manual{,   title = {spatialCCC: Spatial Transcriptomic cell-cell communication analysis},   author = {Seungchan Kim},   year = {2023},   note = {https://github.com/dolchan/spatialCCC, https://skimlab.github.io/spatialCCC/}, }"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"spatialccc-","dir":"","previous_headings":"","what":"Spatial Transcriptomic cell-cell communication analysis","title":"Spatial Transcriptomic cell-cell communication analysis","text":"goal spatialCCC package investigate cell-cell signaling, analyzing ligand-receptor interactions spatial transcriptomic data.","code":""},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Transcriptomic cell-cell communication analysis","text":"can install development version spatialCCC GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"dolchan/spatialCCC\")"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Spatial Transcriptomic cell-cell communication analysis","text":"basic example shows basic workflow package: First, load required R packages. , load built-LR database. Load example Visium spatial transcriptomic data","code":"library(spatialCCC) set.seed(100)  LRdb_m <-    get_LRdb(\"mouse\", n_samples = 100) data_dir <- file.path(\"example\", \"visium_tutorial\") spe_brain <-   SpatialExperiment::read10xVisium(samples = data_dir,                                    type = \"HDF5\",                                    data = \"filtered\")  # Log-Normalize spe_brain <- scater::logNormCounts(spe_brain)"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"cell-cell-communication-analysis","dir":"","previous_headings":"Example","what":"Cell-cell communication analysis","title":"Spatial Transcriptomic cell-cell communication analysis","text":"Compute Cell-Cell Communications ligand-receptor pairs","code":"ccc_graph_list <-   compute_spatial_ccc_graph_list(spe = spe_brain,                                  assay_name = \"logcounts\",                                  LRdb = LRdb_m,                                   workers = 6)"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"cell-cell-commuication-visualization","dir":"","previous_headings":"Example","what":"Cell-cell commuication visualization","title":"Spatial Transcriptomic cell-cell communication analysis","text":"Spatial CCC graph plot tissue image  Spatial CCC graph plot without tissue image case, graph layout can “spatial” keeps original spatial locations, graph layout algorithm supported igraph package.  Spatial CCC graph plot “auto”, .k.., “kk” spring layout format one , one can see distribution cell-cell communication clusters  Spatial CCC graph plot “stress” layout","code":"LR_of_interest <- \"Pdgfb_Pdgfra\"  plot_spatial_ccc_graph(   ccc_graph = ccc_graph_list[[LR_of_interest]],   tissue_img = SpatialExperiment::imgRaster(spe_brain),   node_color = \"group\",   node_size = 1,   node_alpha = 0.5,   edge_color = \"group\",   # clip = TRUE,   which_on_top = \"edge\" ) plot_spatial_ccc_graph(   ccc_graph = ccc_graph_list[[LR_of_interest]],   graph_layout = \"spatial\",   node_color =  \"group\",   node_size = 1,   edge_color = \"group_diameter\",   clip = TRUE,   which_on_top = \"edge\" ) plot_spatial_ccc_graph(   ccc_graph = ccc_graph_list[[LR_of_interest]],   node_color = \"group\",   node_size = 0.1,   edge_color = \"group_diameter\",   edge_width = 0.1,   which_on_top = \"edge\" ) plot_spatial_ccc_graph(   ccc_graph = ccc_graph_list[[LR_of_interest]],   # tissue_img = SpatialExperiment::imgRaster(spe_brain),   graph_layout = \"stress\",   node_color = \"group\",   edge_color = \"group_diameter\",   edge_width = 0.25,   which_on_top = \"edge\" )"},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":null,"dir":"Reference","previous_headings":"","what":"Ligand-receptor database (human) — LRdb_human","title":"Ligand-receptor database (human) — LRdb_human","text":"ligand-receptor database human","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ligand-receptor database (human) — LRdb_human","text":"","code":"LRdb_human"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"lrdb-human","dir":"Reference","previous_headings":"","what":"LRdb_human","title":"Ligand-receptor database (human) — LRdb_human","text":"data frame 3,398 rows 10 columns: LR ligand_receptor pair ligand_gene_symbol, receptor_gene_symbol ligand & receptor gene symbols ligand_gene_id, receptor_gene_id ligand & receptor gene ids - Entrez ID","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Ligand-receptor database (human) — LRdb_human","text":"http://tcm.zju.edu.cn/celltalkdb/download.php","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":null,"dir":"Reference","previous_headings":"","what":"Ligand-receptor database (mouse) — LRdb_mouse","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"ligand-receptor database mouse","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"","code":"LRdb_mouse"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"lrdb-mouse","dir":"Reference","previous_headings":"","what":"LRdb_mouse","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"data frame 2,033 rows 10 columns: LR ligand_receptor pair ligand_gene_symbol, receptor_gene_symbol ligand & receptor gene symbols ligand_gene_id, receptor_gene_id ligand & receptor gene ids - Entrez ID","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"http://tcm.zju.edu.cn/celltalkdb/download.php","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_annots_to_nodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Add annotations to nodes — add_annots_to_nodes","title":"Add annotations to nodes — add_annots_to_nodes","text":"Add annotations nodes","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_annots_to_nodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add annotations to nodes — add_annots_to_nodes","text":"","code":"add_annots_to_nodes(ccog, node_annots, id_column = \"name\")"},{"path":"https://skimlab.github.io/spatialCCC/reference/add_annots_to_nodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add annotations to nodes — add_annots_to_nodes","text":"ccog CCC graph node_annots annotation table (data.frame).  include ID column used left_join. id_column ID column used join operation tables","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_annots_to_nodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add annotations to nodes — add_annots_to_nodes","text":"CCC graph revised annotations nodes","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_node_annot_to_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Add node annotations to edges — add_node_annot_to_edges","title":"Add node annotations to edges — add_node_annot_to_edges","text":"Annotations added 'src' 'dst' nodes, suffixed \"_src\" \"_dst\", respectively.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_node_annot_to_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add node annotations to edges — add_node_annot_to_edges","text":"","code":"add_node_annot_to_edges(ccog, node_annot_colname)"},{"path":"https://skimlab.github.io/spatialCCC/reference/add_node_annot_to_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add node annotations to edges — add_node_annot_to_edges","text":"ccog CCC graph node_annot_colname column names annotations added edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_node_annot_to_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add node annotations to edges — add_node_annot_to_edges","text":"CCC graph revised annotations edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_tbl_with_cell_annots.html","id":null,"dir":"Reference","previous_headings":"","what":"Amend CCC table with annotations for source and destination cells — amend_ccc_tbl_with_cell_annots","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_tbl_with_cell_annots","text":"Amend CCC table annotations source destination cells","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_tbl_with_cell_annots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_tbl_with_cell_annots","text":"","code":"amend_ccc_tbl_with_cell_annots(ccc_tbl, spe, annot_cols, overwrite = TRUE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_tbl_with_cell_annots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_tbl_with_cell_annots","text":"ccc_tbl CCC table, output compute_spatial_ccc_tbl() spe SpatialExperiment object annot_cols column names colData(spe), matched source destination cells added separately: annot_cols.src, .dst overwrite TRUE, previous columns colliding new columns (annot_cols.src, dst) reset.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate distance between spots — calc_spot_dist","title":"Calculate distance between spots — calc_spot_dist","text":"Calculate distance spots","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate distance between spots — calc_spot_dist","text":"","code":"calc_spot_dist(spe, long_format = TRUE, spot_dist_cutoff = 1.5)"},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate distance between spots — calc_spot_dist","text":"spe SpatialExperiment object long_format TRUE (default), return long format data.frame. Otherwise, matrix format. spot_dist_cutoff cutoff value norm.d spot distances. Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate distance between spots — calc_spot_dist","text":"data fame computed distance including d norm.d. norm.d multiple shortest distance spots.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calculate_LR_percent_rank.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","title":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","text":"Calculate (combined) percent rank n LRscore","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calculate_LR_percent_rank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","text":"","code":"calculate_LR_percent_rank(ccc_graph_ls)"},{"path":"https://skimlab.github.io/spatialCCC/reference/calculate_LR_percent_rank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","text":"ccc_graph_ls list spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calculate_LR_percent_rank.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","text":"data frame (tibble)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calculate_LR_percent_rank.html","id":"ccc-graph-percent-rank","dir":"Reference","previous_headings":"","what":"CCC_graph_percent_rank","title":"Calculate (combined) percent rank of n and LRscore — calculate_LR_percent_rank","text":"table returned, n:  number edges CCC graph (LR), LRscore: median LRscores CCC graph n_perc_rank:  percent rank n LRscore_perc_rank: percent rank LRscore (median) perc_rank: combined percent rank (geometric mean n_perc_rank LRscore_perc_rank) perc_group: binned perc_rank","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Subtract a spatial CCC graph (ccog2) from another (ccog1) — ccc_graph_diff","title":"Subtract a spatial CCC graph (ccog2) from another (ccog1) — ccc_graph_diff","text":"Subtract spatial CCC graph (ccog2) another (ccog1)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subtract a spatial CCC graph (ccog2) from another (ccog1) — ccc_graph_diff","text":"","code":"ccc_graph_diff(ccog1, ccog2)"},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subtract a spatial CCC graph (ccog2) from another (ccog1) — ccc_graph_diff","text":"ccog1, ccog2 spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subtract a spatial CCC graph (ccog2) from another (ccog1) — ccc_graph_diff","text":"spatial CCC graph common edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_intersect.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new spatial CCC graph with common edges — ccc_graph_intersect","title":"Create a new spatial CCC graph with common edges — ccc_graph_intersect","text":"Create new spatial CCC graph common edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_intersect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new spatial CCC graph with common edges — ccc_graph_intersect","text":"","code":"ccc_graph_intersect(ccog1, ccog2)"},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_intersect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new spatial CCC graph with common edges — ccc_graph_intersect","text":"ccog1, ccog2 spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_intersect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new spatial CCC graph with common edges — ccc_graph_intersect","text":"spatial CCC graph common edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_union.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine two CCC graphs — ccc_graph_union","title":"Combine two CCC graphs — ccc_graph_union","text":"Combine two CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_union.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine two CCC graphs — ccc_graph_union","text":"","code":"ccc_graph_union(ccog1, ccog2)"},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_union.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine two CCC graphs — ccc_graph_union","text":"ccog1, ccog2 spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/ccc_graph_union.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine two CCC graphs — ccc_graph_union","text":"flattened spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a spatial CCC graph — compute_spatial_ccc_graph","title":"Compute a spatial CCC graph — compute_spatial_ccc_graph","text":"Compute spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a spatial CCC graph — compute_spatial_ccc_graph","text":"","code":"compute_spatial_ccc_graph(   spe,   assay_name = \"logcounts\",   ligand,   receptor,   expression_min_prop = 0.05,   spot_dist = calc_spot_dist(spe),   spot_dist_cutoff = 1.5,   LRscore_cutoff = 0.5 )"},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a spatial CCC graph — compute_spatial_ccc_graph","text":"spe SpatialExperiment object assay_name assay name string ligand ligand receptor receptor expression_min_prop minimum proportion samples non-zero expression value (default: 0.05) spot_dist distances spots, output calc_spot_dist() spot_dist_cutoff cutoff value norm.d spot distances. Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors. LRscore_cutoff minimum LRscore keep","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a spatial CCC graph — compute_spatial_ccc_graph","text":"spatial CCC graphs tidygraph format; spatial CCC graph also include following graph metrics","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph.html","id":"graph-metrics","dir":"Reference","previous_headings":"","what":"graph metrics","title":"Compute a spatial CCC graph — compute_spatial_ccc_graph","text":"overall graph, graph_n_nodes, graph_n_edges graph_component_count graph_motif_count graph_diameter graph_un_diameter graph_mean_dist graph_circuit_rank = graph_n_edges - graph_n_nodes + graph_component_count graph_reciprocity graph_clique_num (sp_ccc_graph assumed undirected) graph_clique_count (sp_ccc_graph assumed undirected) sub-graph (group_components()) group_n_nodes group_n_edges group_adhesion group_motif_count group_diameter group_un_diameter group_mean_dist group_girth group_circuit_rank group_reciprocity","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","title":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","text":"Compute spatial CCC graphs list LR pairs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","text":"","code":"compute_spatial_ccc_graph_list(   spe,   assay_name = \"logcounts\",   LRdb,   expression_min_prop = 0.05,   spot_dist_cutoff = 1.5,   LRscore_cutoff = 0.5,   workers = 1 )"},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","text":"spe SpatialExperiment object assay_name assay name string LRdb LRdb data.frame (see get_LRdb()) expression_min_prop minimum proportion samples non-zero expression value (default: 0.05) spot_dist_cutoff cutoff value norm.d spot distances. Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors. LRscore_cutoff minimum LRscore keep workers number processes used parallel processing","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","text":"list spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_graph_list.html","id":"graph-metrics","dir":"Reference","previous_headings":"","what":"graph metrics","title":"Compute spatial CCC graphs over a list of LR pairs — compute_spatial_ccc_graph_list","text":"overall graph, graph_n_nodes, graph_n_edges graph_component_count graph_motif_count graph_diameter graph_un_diameter graph_mean_dist graph_circuit_rank = graph_n_edges - graph_n_nodes + graph_component_count graph_reciprocity graph_clique_num (sp_ccc_graph assumed undirected) graph_clique_count (sp_ccc_graph assumed undirected) sub-graph (group_components()) group_n_nodes group_n_edges group_adhesion group_motif_count group_diameter group_un_diameter group_mean_dist group_girth group_circuit_rank group_reciprocity","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","title":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","text":"Compute ligand-receptor interactions (LRscore) neighboring spots. Neighboring spots norm.d < spot_dist_cutoff.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","text":"","code":"compute_spatial_ccc_tbl(   spe,   assay_name = \"logcounts\",   ligand,   receptor,   expression_min_prop = 0.05,   spot_dist = calc_spot_dist(spe),   spot_dist_cutoff = 1.5,   LRscore_cutoff = 0.5 )"},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","text":"spe SpatialExperiment object assay_name assay name string ligand ligand receptor receptor expression_min_prop minimum proportion samples non-zero expression value (default: 0.05) spot_dist distances spots, output calc_spot_dist() spot_dist_cutoff cutoff value norm.d spot distances. Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors. LRscore_cutoff minimum LRscore keep","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","text":"LRscore table data.frame following columns: src, dst source destination cells/spots d, norm.d cell-cell/spot-spot distance normalized distance ligand, receptor ligand & receptor genes LRscore LRscore -- see weight weight -- reciprocal norm.d WLRscore weighted LRscore = \\(weight \\cdot LRscore\\)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc_tbl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute spatial ligand-receptor interactions — compute_spatial_ccc_tbl","text":"$$LRscore = \\frac{\\sqrt{x_L \\cdot x_R}}{\\sqrt{x_L \\cdot x_R} + C}$$ \\(x_L\\) \\(x_R\\) expression values ligand (L) receptor (R), \\(C\\) average gene expression across genes samples. source: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7261168/","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"Compute cell overlap distance","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"","code":"dist_cell_overlap_ccc_tbl(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"ccc_tbl CCC graph tabular format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"Jaccard distance matrix format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_spatial_ccc_graph_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert spatial CCC graphs to spatial CCC table — extract_spatial_ccc_graph_edges","title":"Convert spatial CCC graphs to spatial CCC table — extract_spatial_ccc_graph_edges","text":"Convert spatial CCC graphs spatial CCC table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_spatial_ccc_graph_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert spatial CCC graphs to spatial CCC table — extract_spatial_ccc_graph_edges","text":"","code":"extract_spatial_ccc_graph_edges(ccc_graph_ls)"},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_spatial_ccc_graph_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert spatial CCC graphs to spatial CCC table — extract_spatial_ccc_graph_edges","text":"ccc_graph_ls list spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_spatial_ccc_graph_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert spatial CCC graphs to spatial CCC table — extract_spatial_ccc_graph_edges","text":"spatial CCC table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/flatten_ccc_graph_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","title":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","text":"Flatten multiple CCC graphs aggregate one","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/flatten_ccc_graph_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","text":"","code":"flatten_ccc_graph_list(ccc_graph_ls)"},{"path":"https://skimlab.github.io/spatialCCC/reference/flatten_ccc_graph_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","text":"ccc_graph_ls list spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/flatten_ccc_graph_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","text":"spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/flatten_ccc_graph_list.html","id":"flattening-ccc-graph","dir":"Reference","previous_headings":"","what":"flattening_CCC_graph","title":"Flatten multiple CCC graphs into aggregate one — flatten_ccc_graph_list","text":"following node parameters kept: name spot_x, spot_y in_tissue array_row, array_col sizeFactor following node parameters aggregated LR pairs: n, n.src, n.dst, LRscore.sum.src, LRscore.sum.dst summed. node_is_src node_is_dst 'd n.inflow LRscore.sum.inflow summed.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Return LRdb table — get_LRdb","title":"Return LRdb table — get_LRdb","text":"get_LRdb() returns full size table get_LRdb_small() returns smaller table, useful testing. See LRdb_human LRdb_mouse detail database.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return LRdb table — get_LRdb","text":"","code":"get_LRdb(species = c(\"human\", \"mouse\"), n_samples = 0)"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return LRdb table — get_LRdb","text":"species string, either \"human\" (default) \"mouse\" n_samples number LR-pairs sample; 0, return full table.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return LRdb table — get_LRdb","text":"LRdb table data frame","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return LRdb table — get_LRdb","text":"","code":"LRdb <- get_LRdb(species = \"human\")"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get spatial coordinates — get_spatial_data","title":"Get spatial coordinates — get_spatial_data","text":"Returns default spatial coordinates scaled coordinates, spot_x spot_y.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get spatial coordinates — get_spatial_data","text":"","code":"get_spatial_data(spe)"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get spatial coordinates — get_spatial_data","text":"spe SpatialExperiment object","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get spatial coordinates — get_spatial_data","text":"spatial coordinates data.frame cell_id, ... (spatialCoords(spe)), spot_x, spot_y.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"Compute cell overlap distance","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"","code":"lf_cell_overlap_ccc_tbl(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"ccc_tbl CCC graph tabular format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"Jaccard distance long format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert distance in long format to matrix — lf_to_dist","title":"Convert distance in long format to matrix — lf_to_dist","text":"ensures columns rows features","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert distance in long format to matrix — lf_to_dist","text":"","code":"lf_to_dist(lf)"},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert distance in long format to matrix — lf_to_dist","text":"lf distance long format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert distance in long format to matrix — lf_to_dist","text":"distance matrix format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot spatial CCC graph — plot_spatial_ccc_graph","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"Visualize spatial CCC graph various formats, w/ w/o tissue image","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"","code":"plot_spatial_ccc_graph(   ccc_graph,   graph_layout = \"auto\",   cells_of_interest = NULL,   edges_expanded_to_group = TRUE,   edge_color = \"LRscore\",   node_color = \"LRscore.sum.src\",   edge_color_range = NULL,   node_color_range = NULL,   edge_width = 0.5,   edge_alpha = 1,   node_size = 0.5,   node_alpha = 1,   clip = TRUE,   tissue_img = NULL,   image_alpha = NA,   which_on_top = \"edge\",   show_arrow = FALSE )"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"ccc_graph spatial CCC graph LR pair graph_layout string graph layout algorithm. Default \"auto\"; see Details information cells_of_interest array cell ids highlight. edges_expanded_to_group TRUE cells_of_interest given, nodes edges expanded include nodes edges belong groups cells_of_interest belong . edge_color, node_color column name used edge node colors, respectively edge_color_range, node_color_range bound given c(min, max) format. specified, ranges set using values, instead ones derived data.  Useful multiple plots combined later comparison. edge_width, node_size specify edge width node size.  Currently, default values work well.  Might need manual adjustments. edge_alpha, node_alpha specify transparency edges nodes clip TRUE (dafault), tissue_img cliped show active cell-cell communications tissue_img Raster image, like imgRaster(spe) image_alpha alpha value tissue_img. NA, keep current value. which_on_top either \"edge\" \"node\" show_arrow TRUE, arrow added edge.  Default FALSE.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"ggplot object spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"CCC graph tissue image. format, spots placed original locations, keeping spatial relations. CCC graph without tissue image. format, spots placed using either original locations (\"spatial\") user-specified graph layout algorithm.  Default (\"kk\" = igraph::layout_with_kk()) algorithm. See create_layout() available algorithms.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"","code":"if (FALSE) { plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        tissue_img = imgRaster(spe),                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\")  plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\")  plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        graph_layout = \"stress\",                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\") }"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot spatial feature — plot_spatial_feature","title":"Plot spatial feature — plot_spatial_feature","text":"Visualize spatial features w/ w/o tissue image","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot spatial feature — plot_spatial_feature","text":"","code":"plot_spatial_feature(   spe,   feature,   cells_of_interest = NULL,   spot_size = 1.6,   spot_alpha = 1,   image_alpha = NA,   show_tissue_image = TRUE,   clip = TRUE )"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot spatial feature — plot_spatial_feature","text":"spe SpatialExperiment object feature string, column name feature visualized cells_of_interest array cell ids highlight. spot_size specify size spot (feature).  Currently, default values work well.  Might need manual adjustments. spot_alpha specify transparency spot (feature) image_alpha alpha value tissue image. NA, keep current value. show_tissue_image TRUE, tissue image shown. clip TRUE (dafault), tissue image cliped size cover spots","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot spatial feature — plot_spatial_feature","text":"ggplot object spatial feature plot","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot spatial feature — plot_spatial_feature","text":"spots placed original locations, keeping spatial relations.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot spatial feature — plot_spatial_feature","text":"","code":"if (FALSE) { plot_spatial_features(spe,                       feature = \"mclust_6\")  plot_spatial_features(spe,                       feature = \"mclust_6\",                       image_alpha = 0.75) }"},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_tbl_default_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Set default cluster in CCC table — set_ccc_tbl_default_cluster","title":"Set default cluster in CCC table — set_ccc_tbl_default_cluster","text":"Set default cluster CCC table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_tbl_default_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set default cluster in CCC table — set_ccc_tbl_default_cluster","text":"","code":"set_ccc_tbl_default_cluster(ccc_tbl, cluster_name)"},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_tbl_default_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set default cluster in CCC table — set_ccc_tbl_default_cluster","text":"ccc_tbl CCC table, output compute_spatial_ccc_tbl() cluster_name string, name default cluster. cluster_name.src cluster_name.dst columns copied \"cluster.src\" \"cluster.dst\".","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_tbl_default_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set default cluster in CCC table — set_ccc_tbl_default_cluster","text":"CCC table amended columns","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC-package.html","id":null,"dir":"Reference","previous_headings":"","what":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","title":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","text":"Analyze ligand-receptor interactions spatial graph, using spatial transcriptomic data.","code":""},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","text":"Maintainer: Seungchan Kim dolchan@gmail.com (ORCID)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC_example.html","id":null,"dir":"Reference","previous_headings":"","what":"List example files for spatialCCC package — spatialCCC_example","title":"List example files for spatialCCC package — spatialCCC_example","text":"List example files spatialCCC package","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List example files for spatialCCC package — spatialCCC_example","text":"","code":"spatialCCC_example(path = NULL)"},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC_example.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List example files for spatialCCC package — spatialCCC_example","text":"path path example file","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC_example.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List example files for spatialCCC package — spatialCCC_example","text":"list example files called parameter, absolute path example file called example file","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/split_ccc_tbl_LR.html","id":null,"dir":"Reference","previous_headings":"","what":"Split LR into L and R — split_ccc_tbl_LR","title":"Split LR into L and R — split_ccc_tbl_LR","text":"Split LR L R","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/split_ccc_tbl_LR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split LR into L and R — split_ccc_tbl_LR","text":"","code":"split_ccc_tbl_LR(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/split_ccc_tbl_LR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split LR into L and R — split_ccc_tbl_LR","text":"ccc_tbl output extract_spatial_ccc_graph_edges() table \"LR\" column \"$L_$R\" format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell","text":"internal function","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell","text":"","code":"summarise_ccc_by_cell(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell","text":"ccc_tbl CCC graph table.  see compute_spatial_ccc_tbl().","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize spatial CCC graph list to graph/group metrics table — summarize_ccc_graph_metrics","title":"Summarize spatial CCC graph list to graph/group metrics table — summarize_ccc_graph_metrics","text":"Summarize spatial CCC graph list graph/group metrics table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize spatial CCC graph list to graph/group metrics table — summarize_ccc_graph_metrics","text":"","code":"summarize_ccc_graph_metrics(ccc_graph_ls, level = c(\"graph\", \"group\"))"},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize spatial CCC graph list to graph/group metrics table — summarize_ccc_graph_metrics","text":"ccc_graph_ls list spatial CCC graph, output to_spatial_ccc_graph. level extract graph metrics either overall graph (\"graph\") subgraph (\"group\")","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize spatial CCC graph list to graph/group metrics table — summarize_ccc_graph_metrics","text":"graph metrics table summarized LR pair","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"Add additional columns nodes CCC graph: InCOI = TRUE node included COIs connected node COIs tagged = TRUE node included group includes COIs, edges_expanded_to_group = TRUE","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"","code":"tag_cells_in_ccc_graph(ccog, COIs, edges_expanded_to_group = FALSE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"ccog CCC graph COIs array nodes highlight edges_expanded_to_group TRUE,","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"CCC graph InCOI tagged columns (see )","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"Tidy CCC graph removing isolated nodes","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"","code":"tidy_up_ccc_graph(ccog)"},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"ccog CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"CCC graph isolated nodes removed.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_LR_summary_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","title":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","text":"Summarize spatial CCC graph LR","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_LR_summary_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","text":"","code":"to_LR_summary_tbl(ccc_graph_ls)"},{"path":"https://skimlab.github.io/spatialCCC/reference/to_LR_summary_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","text":"ccc_graph_ls list spatial CCC graph, output to_spatial_ccc_graph.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_LR_summary_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","text":"spatial CCC graph summarized LR, aggregating LRscores graph computing percentile ranks.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_LR_summary_tbl.html","id":"ccc-graph-percent-rank","dir":"Reference","previous_headings":"","what":"CCC_graph_percent_rank","title":"Summarize spatial CCC graph for LR — to_LR_summary_tbl","text":"table returned, n:  number edges CCC graph (LR), LRscore: median LRscores CCC graph n_perc_rank:  percent rank n LRscore_perc_rank: percent rank LRscore (median) perc_rank: combined percent rank (geometric mean n_perc_rank LRscore_perc_rank) perc_group: binned perc_rank","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CCC table to CCC graph — to_spatial_ccc_graph","title":"Convert CCC table to CCC graph — to_spatial_ccc_graph","text":"Convert CCC table CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CCC table to CCC graph — to_spatial_ccc_graph","text":"","code":"to_spatial_ccc_graph(ccc_tbl, spatial_data)"},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CCC table to CCC graph — to_spatial_ccc_graph","text":"ccc_tbl output compute_spatial_ccc_tbl() spatial_data table spatial coordinates spots/cells spatial transcriptomic data.  spatial_data includes cell_id, spot_x, spot_y, used ; Otherwise, use first three columns cell_id, spot_x, spot_y","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert CCC table to CCC graph — to_spatial_ccc_graph","text":"spatial CCC graph -- tidygraph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"graph-metrics","dir":"Reference","previous_headings":"","what":"graph metrics","title":"Convert CCC table to CCC graph — to_spatial_ccc_graph","text":"overall graph, graph_n_nodes, graph_n_edges graph_component_count graph_motif_count graph_diameter graph_un_diameter graph_mean_dist graph_circuit_rank = graph_n_edges - graph_n_nodes + graph_component_count graph_reciprocity graph_clique_num (sp_ccc_graph assumed undirected) graph_clique_count (sp_ccc_graph assumed undirected) sub-graph (group_components()) group_n_nodes group_n_edges group_adhesion group_motif_count group_diameter group_un_diameter group_mean_dist group_girth group_circuit_rank group_reciprocity","code":""}]
