[{"path":"https://skimlab.github.io/spatialCCC/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 spatialCCC authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://skimlab.github.io/spatialCCC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Seungchan Kim. Author, maintainer.","code":""},{"path":"https://skimlab.github.io/spatialCCC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kim S (2023). spatialCCC: Spatial Transcriptomic cell-cell communication analysis. https://github.com/dolchan/spatialCCC, https://skimlab.github.io/spatialCCC/.","code":"@Manual{,   title = {spatialCCC: Spatial Transcriptomic cell-cell communication analysis},   author = {Seungchan Kim},   year = {2023},   note = {https://github.com/dolchan/spatialCCC, https://skimlab.github.io/spatialCCC/}, }"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"spatialccc-","dir":"","previous_headings":"","what":"Spatial Transcriptomic cell-cell communication analysis","title":"Spatial Transcriptomic cell-cell communication analysis","text":"goal spatialCCC package investigate cell-cell signaling, analyzing ligand-receptor interactions spatial transcriptomic data.","code":""},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Transcriptomic cell-cell communication analysis","text":"can install development version spatialCCC GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"dolchan/spatialCCC\")"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Spatial Transcriptomic cell-cell communication analysis","text":"basic example shows basic workflow package:","code":""},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"load-necessary-packages","dir":"","previous_headings":"","what":"Load necessary packages","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"library(SpatialExperiment) library(scater) library(dplyr) library(tidyr) library(magrittr) library(purrr) library(ggplot2) library(patchwork)  library(ggraph) library(tidygraph) library(RColorBrewer)  library(ggtree)"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"load-spatialccc-package","dir":"","previous_headings":"Load necessary packages","what":"Load spatialCCC package","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"library(spatialCCC) ## basic example code"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"load-built-in-lrdb","dir":"","previous_headings":"Ligand-Receptor Database","what":"Load built-in LRdb","title":"Spatial Transcriptomic cell-cell communication analysis","text":"LRdb downloaded CellTalkDB: [http://tcm.zju.edu.cn/celltalkdb/download.php]. can see detail : also created getter functions, get_LRdb() get_LRdb_small(), retrieve database.","code":"?LRdb_human ?LRdb_mouse LRdb_m <-    get_LRdb_small(\"mouse\")  LRdb_m %>%    arrange(ligand_gene_symbol, receptor_gene_symbol) #> # A tibble: 105 × 10 #>    LR    ligand_gene_symbol receptor_gene_symbol ligand_gene_id receptor_gene_id #>    <chr> <chr>              <chr>                         <dbl>            <dbl> #>  1 Adam… Adam10             Tspan14                       11487            52588 #>  2 Adam… Adam15             Itgav                         11490            16410 #>  3 Adam… Adam17             Itga6                         11491            16403 #>  4 Adcy… Adcyap1            Vipr2                         11516            22355 #>  5 Adip… Adipoq             Adipor1                       11450            72674 #>  6 Afdn… Afdn               Nrxn3                         17356            18191 #>  7 Apob… Apob               Apobr                        238055           171504 #>  8 Apob… Apob               Lsr                          238055            54135 #>  9 Apoe… Apoe               Ldlr                          11816            16835 #> 10 Apoe… Apoe               Lrp6                          11816            16974 #> # ℹ 95 more rows #> # ℹ 5 more variables: ligand_ensembl_protein_id <chr>, #> #   receptor_ensembl_protein_id <chr>, ligand_ensembl_gene_id <chr>, #> #   receptor_ensembl_gene_id <chr>, evidence <chr>"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"load-visium-spatial-transcriptomic-data","dir":"","previous_headings":"","what":"Load Visium spatial transcriptomic data","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"data_dir <- file.path(\"example\", \"visium_tutorial\") spe_brain <-   SpatialExperiment::read10xVisium(samples = data_dir,                                    type = \"HDF5\",                                    data = \"filtered\")  # to keep track of cell IDs # spe_brain[[\"cell_id\"]] <- colnames(spe_brain)  # Log-Normalize spe_brain <- logNormCounts(spe_brain)"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"cell-cluster-data","dir":"","previous_headings":"","what":"Cell cluster data","title":"Spatial Transcriptomic cell-cell communication analysis","text":"Now, let’s read cell cluster data, obtained using GraphST.","code":"cell_clusters <-   read.csv(\"example/visium_tutorial/outs/graphST.csv\", row.names = 1)  # Make sure the rows of cell_clusters are in the same order of spe_brain. cell_clusters <- cell_clusters[colnames(spe_brain), ]  cluster_ids <- colnames(cell_clusters) cluster_ids <- cluster_ids[grep(\"mclust_\", cluster_ids)]  for (cid in cluster_ids) {   spe_brain[[cid]] <- factor(cell_clusters[[cid]]) } plot_spatial_feature(spe = spe_brain, feature = \"mclust_8\")"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"compute-cell-cell-communications-over-ligand-receptor-pairs","dir":"","previous_headings":"","what":"Compute Cell-Cell Communications over ligand-receptor pairs","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"# For full LRdb analysis, future::plan can be used  #   for parallelization # future::plan(future::multisession, workers = 4)  tictoc::tic() ccc_tbl <- compute_spatial_ccc(spe = spe_brain,                                 assay_name = \"logcounts\",                                LRdb = LRdb_m) tictoc::toc() #> 7.039 sec elapsed  # future::plan(future::sequential) ccc_tbl %>%    dplyr::arrange(desc(LRscore)) #> # A tibble: 160,620 × 10 #>    src          dst       d norm.d LR    ligand receptor LRscore weight WLRscore #>    <chr>        <chr> <dbl>  <dbl> <chr> <chr>  <chr>      <dbl>  <dbl>    <dbl> #>  1 GCGAGAGTTGC… GCGA…    0    0    Apoe… Apoe   Lrp6       0.874  1        0.874 #>  2 GTTCATCGTTT… GCGA…  138    1.01 Apoe… Apoe   Lrp6       0.869  0.986    0.857 #>  3 ACTTTACCCTC… GCGA…  138.   1.01 Apoe… Apoe   Lrp6       0.868  0.980    0.851 #>  4 AGATGATGGAG… GCGA…  138.   1.01 Apoe… Apoe   Lrp6       0.867  0.980    0.849 #>  5 GATATGGATTA… GATA…    0    0    Clu_… Clu    Lrp8       0.858  1        0.858 #>  6 AGAAGTGATTC… AATG…  138    1.01 Calm… Calm1  Kcnq3      0.858  0.986    0.846 #>  7 TTGCATGCTGA… GTGC…  138.   1.01 Calm… Calm1  Kcnq3      0.858  0.980    0.840 #>  8 CCCAACATACG… GTGC…  138.   1.00 Calm… Calm1  Kcnq3      0.857  0.992    0.850 #>  9 TAACTCCATGG… GACA…  137    1    Clu_… Clu    Vldlr      0.857  1        0.857 #> 10 CGGTGCAGATA… GTGC…  138    1.01 Calm… Calm1  Kcnq3      0.857  0.986    0.845 #> # ℹ 160,610 more rows"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"add-cluster-lables-to-ccc-table","dir":"","previous_headings":"Compute Cell-Cell Communications over ligand-receptor pairs","what":"Add cluster lables to CCC table.","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"ccc_tbl <-   ccc_tbl %>%   amend_ccc_table_with_cell_annots(spe = spe_brain, annot_cols = c(\"mclust_8\", \"mclust_10\")) %>%   set_ccc_table_default_cluster(\"mclust_8\")"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"summarize-cell-cell-communication-between-cell-clusters","dir":"","previous_headings":"Compute Cell-Cell Communications over ligand-receptor pairs","what":"Summarize cell-cell communication between cell clusters","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"ccc_tbl_between_clusters <-   ccc_tbl %>%   group_by(mclust_8.src, mclust_8.dst, LR) %>%   summarise(n = n(),             LRscore.sum = sum(LRscore),             WLRscore.sum = sum(WLRscore)) #> `summarise()` has grouped output by 'mclust_8.src', 'mclust_8.dst'. You can #> override using the `.groups` argument.  ccc_tbl_between_clusters %>%   dplyr::arrange(desc(n)) #> # A tibble: 1,662 × 6 #> # Groups:   mclust_8.src, mclust_8.dst [46] #>    mclust_8.src mclust_8.dst LR               n LRscore.sum WLRscore.sum #>    <fct>        <fct>        <chr>        <int>       <dbl>        <dbl> #>  1 3            3            Calm1_Kcnq3   2845       2183.        2159. #>  2 3            3            Fgf1_Fgfr3    2713       1786.        1766. #>  3 3            3            Clu_Vldlr     2489       1862.        1842. #>  4 3            3            Cx3cl1_Itgav  2470       1681.        1663. #>  5 3            3            L1cam_Itgb1   2262       1461.        1445. #>  6 3            3            Apoe_Ldlr     1953       1487.        1471. #>  7 3            3            Fgf13_Fgfr2   1908       1231.        1218. #>  8 3            3            Adam15_Itgav  1876       1164.        1151. #>  9 3            3            Afdn_Nrxn3    1820       1181.        1168. #> 10 2            2            Calm1_Kcnq3   1788       1424.        1408. #> # ℹ 1,652 more rows ccc_tbl_between_clusters %>%   dplyr::filter(mclust_8.dst != mclust_8.src) %>%   dplyr::arrange(desc(n)) #> # A tibble: 1,278 × 6 #> # Groups:   mclust_8.src, mclust_8.dst [38] #>    mclust_8.src mclust_8.dst LR               n LRscore.sum WLRscore.sum #>    <fct>        <fct>        <chr>        <int>       <dbl>        <dbl> #>  1 3            5            Calm1_Kcnq3    259       203.         200.  #>  2 5            3            Calm1_Kcnq3    203       161.         159.  #>  3 3            5            Cx3cl1_Itgav   202       140.         138.  #>  4 3            5            Clu_Vldlr      181       138.         136.  #>  5 3            8            Fgf13_Fgfr2    159       113.         111.  #>  6 5            3            Afdn_Nrxn3     142        94.8         93.4 #>  7 3            5            Apoe_Lrp6      141       107.         106.  #>  8 1            6            Calm1_Kcnq3    138       111.         110.  #>  9 3            8            Clu_Vldlr      132       103.         102.  #> 10 8            3            Calm1_Kcnq3    132       101.          99.6 #> # ℹ 1,268 more rows"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"convert-ccc-table-to-ccc-graph","dir":"","previous_headings":"Compute Cell-Cell Communications over ligand-receptor pairs","what":"Convert CCC table to CCC graph","title":"Spatial Transcriptomic cell-cell communication analysis","text":"conversion also adds various graph metrics CCC graph. summarize_ccc_graph_metrics() summarize graph metrics LR pair. summarize_ccc_graph_metrics(…, level = “group”) summarizes metrics subgraph (group) CCC graph (LR)","code":"tictoc::tic(\"to_spatical_ccc_graph ...\")  sp_col_data <- get_spatial_data(spe_brain)  ccc_graph_list <-   to_spatial_ccc_graph_list(ccc_tbl, sp_col_data, workers = 6)  tictoc::toc() #> to_spatical_ccc_graph ...: 11.539 sec elapsed tictoc::tic()  ccc_graph_metrics_summary_df <-   summarize_ccc_graph_metrics(ccc_graph_list)  tictoc::toc() #> 0.062 sec elapsed ccc_graph_metrics_summary_df %>%   arrange(graph_component_count) #> # A tibble: 48 × 12 #>    LR        graph_n_nodes graph_n_edges graph_component_count graph_motif_count #>    <chr>             <int>         <dbl>                 <dbl>             <int> #>  1 Calm1_Kc…          2697         13616                     3             24463 #>  2 Clu_Vldlr          2665         10624                     3             20955 #>  3 Cx3cl1_I…          2617         11724                     4             21978 #>  4 Adam15_I…          2388          9187                     4             17301 #>  5 Afdn_Nrx…          2463          8262                     6             16000 #>  6 Clu_Lrp8           2527          7510                     6             15497 #>  7 L1cam_It…          2306          7682                     6             14856 #>  8 Fgf1_Fgf…          2275          7569                     7             14148 #>  9 Adam10_T…          2114          5924                     8             10890 #> 10 Apoe_Lrp6          2497          6612                     9             13761 #> # ℹ 38 more rows #> # ℹ 7 more variables: graph_diameter <dbl>, graph_un_diameter <dbl>, #> #   graph_mean_dist <dbl>, graph_circuit_rank <dbl>, graph_reciprocity <dbl>, #> #   graph_clique_num <int>, graph_clique_count <int> tictoc::tic()  ccc_graph_group_metrics_summary_df <-   summarize_ccc_graph_metrics(ccc_graph_list, level = \"group\")  tictoc::toc() #> 0.062 sec elapsed ccc_graph_group_metrics_summary_df  #> # A tibble: 3,313 × 12 #>    LR         group group_n_nodes group_n_edges group_adhesion group_motif_count #>    <chr>      <int>         <int>         <dbl>          <dbl>             <int> #>  1 Jag1_Notc…    24             3             2              0                 1 #>  2 Jag1_Notc…    46             2             1              0                 0 #>  3 Jag1_Notc…    47             2             1              0                 0 #>  4 Jag1_Notc…    25             3             3              0                 1 #>  5 Jag1_Notc…     1            13            23              0                19 #>  6 Jag1_Notc…    48             2             1              0                 0 #>  7 Jag1_Notc…    49             2             2              0                 0 #>  8 Jag1_Notc…     7             5             5              0                 3 #>  9 Jag1_Notc…    26             3             5              0                 1 #> 10 Jag1_Notc…    90             1             1              0                 0 #> # ℹ 3,303 more rows #> # ℹ 6 more variables: group_diameter <dbl>, group_un_diameter <dbl>, #> #   group_mean_dist <dbl>, group_girth <dbl>, group_circuit_rank <dbl>, #> #   group_reciprocity <dbl>"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"visualization","dir":"","previous_headings":"","what":"Visualization","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"LR_of_interest <- \"App_Dcc\" ccc_graph_list[[LR_of_interest]] %>%   activate(edges) %>%   as_tibble() #> # A tibble: 3,822 × 40 #>     from    to src       dst       d norm.d LR    ligand receptor LRscore weight #>    <int> <int> <chr>     <chr> <dbl>  <dbl> <chr> <chr>  <chr>      <dbl>  <dbl> #>  1     1   577 AAACAAGT… CAGC…  138    1.01 App_… App    Dcc        0.745  0.986 #>  2     1  1938 AAACAAGT… TTCT…  138.   1.01 App_… App    Dcc        0.685  0.980 #>  3     2  1569 AAACAATC… TAGT…  138    1.01 App_… App    Dcc        0.739  0.986 #>  4     3  1251 AAACACCA… GGAA…  138    1.01 App_… App    Dcc        0.671  0.986 #>  5     4     4 AAACAGAG… AAAC…    0    0    App_… App    Dcc        0.798  1     #>  6     4   581 AAACAGAG… CAGC…  138.   1.01 App_… App    Dcc        0.771  0.980 #>  7     5     5 AAACCGGG… AAAC…    0    0    App_… App    Dcc        0.728  1     #>  8     5   805 AAACCGGG… CGCC…  138.   1.01 App_… App    Dcc        0.726  0.980 #>  9     6   699 AAACCTCA… CCGA…  138.   1.01 App_… App    Dcc        0.701  0.980 #> 10     6  1324 AAACCTCA… GGTA…  138.   1.01 App_… App    Dcc        0.714  0.980 #> # ℹ 3,812 more rows #> # ℹ 29 more variables: WLRscore <dbl>, mclust_8.src <chr>, mclust_10.src <chr>, #> #   mclust_8.dst <chr>, mclust_10.dst <chr>, cluster.src <chr>, #> #   cluster.dst <chr>, graph_n_nodes <int>, graph_n_edges <dbl>, #> #   graph_component_count <dbl>, graph_motif_count <int>, graph_diameter <dbl>, #> #   graph_un_diameter <dbl>, graph_mean_dist <dbl>, graph_circuit_rank <dbl>, #> #   graph_reciprocity <dbl>, graph_clique_num <int>, …"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"spatial-ccc-graph-plot-with-tissue-image","dir":"","previous_headings":"Visualization","what":"spatial CCC graph plot with tissue image","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     tissue_img = imgRaster(spe_brain),     node_color = \"mclust_8\",     node_size = 1,     node_alpha = 0.5,     edge_color = \"group\",     # clip = TRUE,     which_on_top = \"edge\"   )  gp_spccc_0 <-   plot_spatial_feature(spe = spe_brain,                        feature = \"mclust_8\") wrap_plots(gp_spccc, gp_spccc_0, ncol = 2) ccc_graph_temp <-   ccc_graph_list[[LR_of_interest]] %>%   tidygraph::activate(\"edges\") %>%   tidygraph::filter(mclust_8.src != mclust_8.dst) %>%   tidy_up_ccc_graph()  cells_of_interest <-   ccc_graph_temp %>%   tidygraph::activate(\"nodes\") %>%   dplyr::pull(\"name\") gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_temp,     tissue_img = SpatialExperiment::imgRaster(spe_brain),     node_color = \"inflow.n\",     node_size = 1.25,     node_alpha = 1,     edge_color = \"group\",     show_arrow = TRUE,     # clip = TRUE,     which_on_top = \"node\"   )  gp_spccc_0 <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     tissue_img = SpatialExperiment::imgRaster(spe_brain),     image_alpha = 0,     cells_of_interest = cells_of_interest,     edges_expanded_to_group = FALSE,     node_color = \"mclust_8\",     node_size = 1.25,     node_alpha = 0.5,     edge_color = \"group\",     show_arrow = TRUE,     # clip = TRUE,     which_on_top = \"node\"   )  gp_spccc_1 <-   plot_spatial_feature(spe = spe_brain,                        feature = \"mclust_8\",                        cells_of_interest = cells_of_interest) wrap_plots(gp_spccc, gp_spccc_1, ncol = 2) gp_spccc_0"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"spatial-ccc-graph-plot-without-tissue-image","dir":"","previous_headings":"Visualization","what":"spatial CCC graph plot without tissue image","title":"Spatial Transcriptomic cell-cell communication analysis","text":"case, graph layout can “spatial” keeps original spatial locations, graph layout algorithm supported igraph package.  uses “auto” layout (“kk” spring layout).  case, “stress” layout.","code":"gp_spccc <-   plot_spatial_ccc_graph(     ccc_graph = ccc_graph_list[[LR_of_interest]],     graph_layout = \"spatial\",     node_color =  \"mclust_8\",     node_size = 1,     edge_color = \"group_diameter\",     clip = TRUE,     # ghost_img = TRUE,     which_on_top = \"edge\"   )  gp_spccc_0 <-   plot_spatial_ccc_graph(     ccc_graph =       ccc_graph_list[[LR_of_interest]],     graph_layout = \"spatial\",     node_color = \"mclust_8\",     node_size = 1,     edge_color = \"group_diameter\",     clip = TRUE,     # ghost_img = TRUE,     which_on_top = \"node\"   ) wrap_plots(gp_spccc, gp_spccc_0, ncol = 2, guides = \"collect\") plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[LR_of_interest]],                        # tissue_img = imgRaster(spe_brain),                        node_color = \"group\",                        node_size = 0.1,                        edge_color = \"group_diameter\",                        edge_width = 0.1,                        which_on_top = \"edge\") plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[LR_of_interest]],                        # tissue_img = imgRaster(spe_brain),                        graph_layout = \"stress\",                        node_color = \"group\",                        edge_color = \"group_diameter\",                        edge_width = 0.25,                        which_on_top = \"edge\")"},{"path":"https://skimlab.github.io/spatialCCC/index.html","id":"cell-overlap-distance","dir":"","previous_headings":"","what":"Cell-overlap distance","title":"Spatial Transcriptomic cell-cell communication analysis","text":"","code":"tictoc::tic()  cell_overlap_dist <-   dist_cell_overlap_ccc_tbl(ccc_tbl)  tictoc::toc() #> 0.422 sec elapsed tictoc::tic()  cell_overlap_lf <-   lf_cell_overlap_ccc_tbl(ccc_tbl)  tictoc::toc() #> 0.503 sec elapsed tictoc::tic()  LRs_high_cell_overlap <-   cell_overlap_lf %>%    dplyr::filter(d < 1) %>%   dplyr::select(lr1, lr2) %>%   unlist() %>% unique()  tictoc::toc() #> 0.002 sec elapsed tictoc::tic()  high_cell_overlap_dist <-   cell_overlap_dist[LRs_high_cell_overlap, LRs_high_cell_overlap]  tictoc::toc() #> 0 sec elapsed tictoc::tic()  high_cell_overlap_dist2 <-   cell_overlap_lf %>%   dplyr::filter(d < 1) %>%   dplyr::select(lr1, lr2, d) %>%   lf_to_dist()  tictoc::toc() #> 0.007 sec elapsed LR_ccc_summary_tbl <-   ccc_tbl %>%    pull(LR) %>%   table() %>%   as_tibble() %>%   rename(\"LR\" = \".\") %>%   arrange(desc(n)) %>%   left_join(     ccc_tbl %>%        select(LR, ligand, receptor) %>%       distinct(),     by = \"LR\"   ) hclus.res <- fastcluster::hclust(as.dist(high_cell_overlap_dist),                                  method = \"complete\") ape::as.phylo(hclus.res) %>%   ggtree(layout=\"dendrogram\") %<+% LR_ccc_summary_tbl +   aes(color=receptor) +   theme(legend.position = \"none\") +   geom_tippoint(aes(size=n), alpha=0.5) +   geom_tiplab(size=2, offset=-0.15) +   xlim_tree(3) ape::as.phylo(hclus.res) %>%   ggtree(layout = \"circular\") %<+% LR_ccc_summary_tbl +   aes(color=receptor) +   # aes(color=ligand) +   theme(legend.position = \"none\") +   geom_tippoint(aes(size=n), alpha=0.5) +   geom_tiplab(size=2, offset=0.05)"},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":null,"dir":"Reference","previous_headings":"","what":"Ligand-receptor database (human) — LRdb_human","title":"Ligand-receptor database (human) — LRdb_human","text":"ligand-receptor database human","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ligand-receptor database (human) — LRdb_human","text":"","code":"LRdb_human"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"lrdb-human","dir":"Reference","previous_headings":"","what":"LRdb_human","title":"Ligand-receptor database (human) — LRdb_human","text":"data frame 3,398 rows 10 columns: LR ligand_receptor pair ligand_gene_symbol, receptor_gene_symbol ligand & receptor gene symbols ligand_gene_id, receptor_gene_id ligand & receptor gene ids - Entrez ID","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_human.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Ligand-receptor database (human) — LRdb_human","text":"http://tcm.zju.edu.cn/celltalkdb/download.php","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":null,"dir":"Reference","previous_headings":"","what":"Ligand-receptor database (mouse) — LRdb_mouse","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"ligand-receptor database mouse","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"","code":"LRdb_mouse"},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"lrdb-mouse","dir":"Reference","previous_headings":"","what":"LRdb_mouse","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"data frame 2,033 rows 10 columns: LR ligand_receptor pair ligand_gene_symbol, receptor_gene_symbol ligand & receptor gene symbols ligand_gene_id, receptor_gene_id ligand & receptor gene ids - Entrez ID","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/LRdb_mouse.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Ligand-receptor database (mouse) — LRdb_mouse","text":"http://tcm.zju.edu.cn/celltalkdb/download.php","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Add various graph metrics to spatial CCC graph — add_spatial_ccc_graph_metrics","title":"Add various graph metrics to spatial CCC graph — add_spatial_ccc_graph_metrics","text":"See tidygraph::graph_measures metrics computed.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add various graph metrics to spatial CCC graph — add_spatial_ccc_graph_metrics","text":"","code":"add_spatial_ccc_graph_metrics(sp_ccc_graph, from_scratch = TRUE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add various graph metrics to spatial CCC graph — add_spatial_ccc_graph_metrics","text":"sp_ccc_graph output to_spatial_ccc_graph() from_scratch TRUE, existing metrics wiped clean. Graph metrics include: overall graph graph_n_nodes graph_n_edges graph_component_count graph_motif_count graph_diameter graph_un_diameter graph_mean_dist graph_circuit_rank = graph_n_edges - graph_n_nodes + graph_component_count graph_reciprocity graph_clique_num (sp_ccc_graph assumed undirected) graph_clique_count (sp_ccc_graph assumed undirected) sub-graph (group_components()) group_n_nodes group_n_edges group_adhesion group_motif_count group_diameter group_un_diameter group_mean_dist group_girth group_circuit_rank group_reciprocity","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics_to_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Copy graph metrics from nodes to edges — add_spatial_ccc_graph_metrics_to_edges","title":"Copy graph metrics from nodes to edges — add_spatial_ccc_graph_metrics_to_edges","text":"Internal function","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics_to_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copy graph metrics from nodes to edges — add_spatial_ccc_graph_metrics_to_edges","text":"","code":"add_spatial_ccc_graph_metrics_to_edges(sp_ccc_graph, from_scratch = TRUE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_ccc_graph_metrics_to_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copy graph metrics from nodes to edges — add_spatial_ccc_graph_metrics_to_edges","text":"sp_ccc_graph output to_spatial_ccc_graph() from_scratch TRUE, existing metrics wiped clean. Graph metrics include: overall graph graph_n_nodes graph_n_edges graph_component_count graph_motif_count graph_diameter graph_un_diameter graph_mean_dist graph_circuit_rank = graph_n_edges - graph_n_nodes + graph_component_count graph_reciprocity graph_clique_num (sp_ccc_graph assumed undirected) graph_clique_count (sp_ccc_graph assumed undirected) sub-graph (group_components()) group_n_nodes group_n_edges group_adhesion group_motif_count group_diameter group_un_diameter group_mean_dist group_girth group_circuit_rank group_reciprocity","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Add spatial data to CCC table — add_spatial_data","title":"Add spatial data to CCC table — add_spatial_data","text":"internal function","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add spatial data to CCC table — add_spatial_data","text":"","code":"add_spatial_data(df, spatial_data)"},{"path":"https://skimlab.github.io/spatialCCC/reference/add_spatial_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add spatial data to CCC table — add_spatial_data","text":"df CCC table. see compute_spatial_ccc(). spatial_data spatial data: cell_id, spot_x, spot_y, ...; contain cell_id, spot_x, spot_y, rest added","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_table_with_cell_annots.html","id":null,"dir":"Reference","previous_headings":"","what":"Amend CCC table with annotations for source and destination cells — amend_ccc_table_with_cell_annots","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_table_with_cell_annots","text":"Amend CCC table annotations source destination cells","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_table_with_cell_annots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_table_with_cell_annots","text":"","code":"amend_ccc_table_with_cell_annots(ccc_table, spe, annot_cols, overwrite = TRUE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/amend_ccc_table_with_cell_annots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Amend CCC table with annotations for source and destination cells — amend_ccc_table_with_cell_annots","text":"ccc_table CCC table, output compute_spatial_ccc() spe SpatialExperiment object annot_cols column names colData(spe), matched source destination cells added separately: annot_cols.src, .dst overwrite TRUE, previous columns colliding new columns (annot_cols.src, dst) reset.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/barebone_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Create barebone CCC graph — barebone_spatial_ccc_graph","title":"Create barebone CCC graph — barebone_spatial_ccc_graph","text":"Create barebone CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/barebone_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create barebone CCC graph — barebone_spatial_ccc_graph","text":"","code":"barebone_spatial_ccc_graph(spe, spot_dist_cutoff = 1.5)"},{"path":"https://skimlab.github.io/spatialCCC/reference/barebone_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create barebone CCC graph — barebone_spatial_ccc_graph","text":"spe SpatialExperiment object spot_dist_cutoff cutoff value norm.d spot distances (see calc_spot_dist()). Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/barebone_spatial_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create barebone CCC graph — barebone_spatial_ccc_graph","text":"spatial CCC graph w/o LRscore","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate distance between spots — calc_spot_dist","title":"Calculate distance between spots — calc_spot_dist","text":"Calculate distance spots","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate distance between spots — calc_spot_dist","text":"","code":"calc_spot_dist(spe, long_format = TRUE, spot_dist_cutoff = 1.5)"},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate distance between spots — calc_spot_dist","text":"spe SpatialExperiment object long_format TRUE (default), return long format data.frame. Otherwise, matrix format. spot_dist_cutoff cutoff value norm.d spot distances (see calc_spot_dist()). Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate distance between spots — calc_spot_dist","text":"data fame computed distance including d norm.d. norm.d multiple shortest distance spots.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist0.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate distance between spots — calc_spot_dist0","title":"Calculate distance between spots — calc_spot_dist0","text":"Calculate distance spots","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate distance between spots — calc_spot_dist0","text":"","code":"calc_spot_dist0(coords, long_format = TRUE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate distance between spots — calc_spot_dist0","text":"coords spatial coordinates data.frame cell_id, x, y order.  column headings matter, just order. long_format TRUE (default), return long format data.frame. Otherwise, matrix format.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/calc_spot_dist0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate distance between spots — calc_spot_dist0","text":"data fame computed distance including d norm.d. norm.d multiple shortest distance spots.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/collapse_to_ccc_by_cell.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate ccc_by_cell_lr to cells — collapse_to_ccc_by_cell","title":"Aggregate ccc_by_cell_lr to cells — collapse_to_ccc_by_cell","text":"Internal function","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/collapse_to_ccc_by_cell.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate ccc_by_cell_lr to cells — collapse_to_ccc_by_cell","text":"","code":"collapse_to_ccc_by_cell(ccc_by_cell_lr)"},{"path":"https://skimlab.github.io/spatialCCC/reference/collapse_to_ccc_by_cell.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate ccc_by_cell_lr to cells — collapse_to_ccc_by_cell","text":"ccc_by_cell_lr see summarise_ccc_by_cell_lr()","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute ligand-receptor interactions — compute_spatial_ccc","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"Compute ligand-receptor interactions (LRscore) neighboring spots. Neighboring spots norm.d < spot_dist_cutoff.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"","code":"compute_spatial_ccc(   spe,   assay_name = \"logcounts\",   LRdb,   expression_min_prop = 0.05,   spot_dist_cutoff = 1.5,   LRscore_cutoff = 0.5 )"},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"spe SpatialExperiment object assay_name assay name string LRdb LRdb data.frame (see get_LRdb()) expression_min_prop minimum proportion samples non-zero expression value (default: 0.05) spot_dist_cutoff cutoff value norm.d spot distances (see calc_spot_dist()). Default cutoff 1.5 comes sqrt(3) ~ 1.73, based Visium spot-array arranged, default, computing nearest neighbors. LRscore_cutoff minimum LRscore keep","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"LRscore table data.frame","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"$$LRscore = \\frac{\\sqrt{x_L \\cdot x_R}}{\\sqrt{x_L \\cdot x_R} + C}$$ \\(x_L\\) \\(x_R\\) expression values ligand (L) receptor (R), \\(C\\) average gene expression across genes samples. source: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7261168/","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/compute_spatial_ccc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute ligand-receptor interactions — compute_spatial_ccc","text":"","code":"if (FALSE) { # read Visium spatial transcriptomic data #   and log-normalize data spe <-   SpatialExperiment::read10xVisium(     samples = data_dir,     type = \"HDF5\",     data = \"filtered\") %>%     logNormCounts()  # get built-in LR datbase for mouse LRdb_mouse <- get_LRdb(\"mouse\")  # calculate LRscores ccc_table <-   compute_spatial_ccc(     spe = spe,     assay_name = \"logcounts\",     LRdb = LRdb_mouse)#' }"},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"Compute cell overlap distance","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"","code":"dist_cell_overlap_ccc_tbl(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"ccc_tbl CCC graph tabular format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute cell overlap distance — dist_cell_overlap_ccc_tbl","text":"Jaccard distance matrix format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_edgesets.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute distance between LRs — dist_cell_overlap_edgesets","title":"Compute distance between LRs — dist_cell_overlap_edgesets","text":"dist_cell_overlap_edgesets() returns Jaccard distance matrix. lf_cell_overlap_edgesets() returns Jaccard distance long format. Calculate Jaccard distance LRs LR set concatenated edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_edgesets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute distance between LRs — dist_cell_overlap_edgesets","text":"","code":"dist_cell_overlap_edgesets(edgeset_list)  lf_cell_overlap_edgesets(edgeset_list)"},{"path":"https://skimlab.github.io/spatialCCC/reference/dist_cell_overlap_edgesets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute distance between LRs — dist_cell_overlap_edgesets","text":"edgeset_list set concatenated edges (see prep_cell_overlap_ccc_tbl())","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_ccc_graph_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract spatial CCC graph metrics — extract_ccc_graph_metrics","title":"Extract spatial CCC graph metrics — extract_ccc_graph_metrics","text":"Extract spatial CCC graph metrics","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_ccc_graph_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract spatial CCC graph metrics — extract_ccc_graph_metrics","text":"","code":"extract_ccc_graph_metrics(ccc_graph, level = c(\"graph\", \"group\"))"},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_ccc_graph_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract spatial CCC graph metrics — extract_ccc_graph_metrics","text":"ccc_graph output to_spatial_ccc_graph() level extract graph metrics either overall graph (\"graph\") subgraph (\"group\")","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/extract_ccc_graph_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract spatial CCC graph metrics — extract_ccc_graph_metrics","text":"one row data.frame graph metrics","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/geom_spatial.html","id":null,"dir":"Reference","previous_headings":"","what":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","title":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","text":"function defines ggplot2::layer() visualizing histology image Visium. can combined ggplot2 functions visualizing clusters plot_spatial_ccc_graph().","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/geom_spatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","text":"","code":"geom_spatial(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = FALSE,   ... )"},{"path":"https://skimlab.github.io/spatialCCC/reference/geom_spatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","text":"mapping Passed ggplot2::layer(mapping) grob, x y required. data Passed ggplot2::layer(data). stat Passed ggplot2::layer(stat). position Passed ggplot2::layer(position). na.rm Passed ggplot2::layer(params = list(na.rm)). show.legend Passed ggplot2::layer(show.legend). inherit.aes Passed ggplot2::layer(inherit.aes). ... arguments passed ggplot2::layer(params = list(...)).","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/geom_spatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","text":"ggplot2::layer() histology information.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/geom_spatial.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A ggplot2 layer for visualizing the Visium histology — geom_spatial","text":"10x Genomics","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Return LRdb table — get_LRdb","title":"Return LRdb table — get_LRdb","text":"get_LRdb() returns full size table get_LRdb_small() returns smaller table, useful testing. See LRdb_human LRdb_mouse detail database.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return LRdb table — get_LRdb","text":"","code":"get_LRdb(species = c(\"human\", \"mouse\"))  get_LRdb_small(species = c(\"human\", \"mouse\"))"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return LRdb table — get_LRdb","text":"species string, either \"human\" (default) \"mouse\"","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return LRdb table — get_LRdb","text":"LRdb table data frame","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_LRdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return LRdb table — get_LRdb","text":"","code":"LRdb <- get_LRdb(species = \"human\")"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get spatial coordinates — get_spatial_data","title":"Get spatial coordinates — get_spatial_data","text":"Returns default spatial coordinates scaled coordinates, spot_x spot_y.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get spatial coordinates — get_spatial_data","text":"","code":"get_spatial_data(spe)"},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get spatial coordinates — get_spatial_data","text":"spe SpatialExperiment object","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/get_spatial_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get spatial coordinates — get_spatial_data","text":"spatial coordinates data.frame cell_id, ... (spatialCoords(spe)), spot_x, spot_y.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"Compute cell overlap distance","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"","code":"lf_cell_overlap_ccc_tbl(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"ccc_tbl CCC graph tabular format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_cell_overlap_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute cell overlap distance — lf_cell_overlap_ccc_tbl","text":"Jaccard distance long format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert distance in long format to matrix — lf_to_dist","title":"Convert distance in long format to matrix — lf_to_dist","text":"ensures columns rows features","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert distance in long format to matrix — lf_to_dist","text":"","code":"lf_to_dist(lf)"},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert distance in long format to matrix — lf_to_dist","text":"lf distance long format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/lf_to_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert distance in long format to matrix — lf_to_dist","text":"distance matrix format","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/modify_alpha_image.html","id":null,"dir":"Reference","previous_headings":"","what":"Modify image with alpha — modify_alpha_image","title":"Modify image with alpha — modify_alpha_image","text":"Modify image alpha","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/modify_alpha_image.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modify image with alpha — modify_alpha_image","text":"","code":"modify_alpha_image(raster, image.alpha = NA)"},{"path":"https://skimlab.github.io/spatialCCC/reference/modify_alpha_image.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modify image with alpha — modify_alpha_image","text":"raster Raster image, like imgRaster(spe) image.alpha alpha value tissue_img. NA, keep current value.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot spatial CCC graph — plot_spatial_ccc_graph","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"Visualize spatial CCC graph various formats, w/ w/o tissue image","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"","code":"plot_spatial_ccc_graph(   ccc_graph,   graph_layout = \"auto\",   cells_of_interest = NULL,   edges_expanded_to_group = TRUE,   edge_color = \"group_n_edges\",   node_color = \"group_n_nodes\",   edge_color_range = NULL,   node_color_range = NULL,   edge_width = 0.5,   edge_alpha = 1,   node_size = 0.5,   node_alpha = 1,   clip = TRUE,   tissue_img = NULL,   image_alpha = NA,   which_on_top = \"edge\",   show_arrow = FALSE )"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"ccc_graph spatial CCC graph LR pair graph_layout string graph layout algorithm. Default \"auto\"; see Details information cells_of_interest array cell ids highlight. edges_expanded_to_group TRUE cells_of_interest given, nodes edges expanded include nodes edges belong groups cells_of_interest belong . edge_color, node_color column name used edge node colors, respectively edge_color_range, node_color_range bound given c(min, max) format. specified, ranges set using values, instead ones derived data.  Useful multiple plots combined later comparison. edge_width, node_size specify edge width node size.  Currently, default values work well.  Might need manual adjustments. edge_alpha, node_alpha specify transparency edges nodes clip TRUE (dafault), tissue_img cliped show active cell-cell communications tissue_img Raster image, like imgRaster(spe) image_alpha alpha value tissue_img. NA, keep current value. which_on_top either \"edge\" \"node\" show_arrow TRUE, arrow added edge.  Default FALSE.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"CCC graph tissue image. format, spots placed original locations, keeping spatial relations. CCC graph without tissue image. format, spots placed using either original locations (\"spatial\") user-specified graph layout algorithm.  Default (\"kk\" = igraph::layout_with_kk()) algorithm. See create_layout() available algorithms.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_ccc_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot spatial CCC graph — plot_spatial_ccc_graph","text":"","code":"if (FALSE) { plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        tissue_img = imgRaster(spe),                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\")  plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\")  plot_spatial_ccc_graph(ccc_graph = ccc_graph_list[[\"App_Dcc\"]],                        graph_layout = \"stress\",                        node_color = \"group_diameter\",                        node_size = 1,                        edge_color = \"group_diameter\",                        which_on_top = \"edge\") }"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot spatial feature — plot_spatial_feature","title":"Plot spatial feature — plot_spatial_feature","text":"Visualize spatial features w/ w/o tissue image","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot spatial feature — plot_spatial_feature","text":"","code":"plot_spatial_feature(   spe,   feature,   cells_of_interest = NULL,   spot_size = 1.6,   spot_alpha = 1,   image_alpha = NA,   show_tissue_image = TRUE,   clip = TRUE )"},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot spatial feature — plot_spatial_feature","text":"spe SpatialExperiment object feature string, column name feature visualized cells_of_interest array cell ids highlight. spot_size specify size spot (feature).  Currently, default values work well.  Might need manual adjustments. spot_alpha specify transparency spot (feature) image_alpha alpha value tissue image. NA, keep current value. show_tissue_image TRUE, tissue image shown. clip TRUE (dafault), tissue image cliped size cover spots","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot spatial feature — plot_spatial_feature","text":"spots placed original locations, keeping spatial relations.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/plot_spatial_feature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot spatial feature — plot_spatial_feature","text":"","code":"if (FALSE) { plot_spatial_features(spe,                       feature = \"mclust_6\")  plot_spatial_features(spe,                       feature = \"mclust_6\",                       image_alpha = 0.75) }"},{"path":"https://skimlab.github.io/spatialCCC/reference/prep_cell_overlap_ccc_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare CCC table for distance calcuation — prep_cell_overlap_ccc_tbl","title":"Prepare CCC table for distance calcuation — prep_cell_overlap_ccc_tbl","text":"Reorganize CCC table list element CCC graph, edge list edge, (src, dst) pair, concatenated src_dst string easy enumeration later.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/prep_cell_overlap_ccc_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare CCC table for distance calcuation — prep_cell_overlap_ccc_tbl","text":"","code":"prep_cell_overlap_ccc_tbl(ccc_tbl)"},{"path":"https://skimlab.github.io/spatialCCC/reference/prep_cell_overlap_ccc_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare CCC table for distance calcuation — prep_cell_overlap_ccc_tbl","text":"ccc_tbl CCC table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/prep_cell_overlap_ccc_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare CCC table for distance calcuation — prep_cell_overlap_ccc_tbl","text":"list CCC graph list concatenated edges","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_table_default_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Set default cluster in CCC table — set_ccc_table_default_cluster","title":"Set default cluster in CCC table — set_ccc_table_default_cluster","text":"Set default cluster CCC table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_table_default_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set default cluster in CCC table — set_ccc_table_default_cluster","text":"","code":"set_ccc_table_default_cluster(ccc_table, cluster_name)"},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_table_default_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set default cluster in CCC table — set_ccc_table_default_cluster","text":"ccc_table CCC table, output compute_spatial_ccc() cluster_name string, name default cluster. cluster_name.src cluster_name.dst columns copied \"cluster.src\" \"cluster.dst\".","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/set_ccc_table_default_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set default cluster in CCC table — set_ccc_table_default_cluster","text":"CCC table amended columns","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC-package.html","id":null,"dir":"Reference","previous_headings":"","what":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","title":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","text":"Investigate cell-cell signaling, analyzing ligand-receptor interactions spatial transcriptomic data.","code":""},{"path":[]},{"path":"https://skimlab.github.io/spatialCCC/reference/spatialCCC-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"spatialCCC: Spatial Transcriptomic cell-cell communication analysis — spatialCCC-package","text":"Maintainer: Seungchan Kim dolchan@gmail.com (ORCID)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell_lr.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell_lr","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell_lr","text":"internal function","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell_lr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell_lr","text":"","code":"summarise_ccc_by_cell_lr(ccc_table)"},{"path":"https://skimlab.github.io/spatialCCC/reference/summarise_ccc_by_cell_lr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize CCC table by (cell, LR) — summarise_ccc_by_cell_lr","text":"ccc_table CCC graph table.  see compute_spatial_ccc().","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize spatial CCC graph list to table — summarize_ccc_graph_metrics","title":"Summarize spatial CCC graph list to table — summarize_ccc_graph_metrics","text":"Summarize spatial CCC graph list table","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize spatial CCC graph list to table — summarize_ccc_graph_metrics","text":"","code":"summarize_ccc_graph_metrics(ccc_graph_list, level = c(\"graph\", \"group\"))"},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize spatial CCC graph list to table — summarize_ccc_graph_metrics","text":"ccc_graph_list list spatial CCC graph, output to_spatial_ccc_graph. level extract graph metrics either overall graph (\"graph\") subgraph (\"group\")","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/summarize_ccc_graph_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize spatial CCC graph list to table — summarize_ccc_graph_metrics","text":"graph metrics table summarized LR pair","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"Add additional columns nodes CCC graph: InCOI = TRUE node included COIs connected node COIs tagged = TRUE node included group includes COIs, edges_expanded_to_group = TRUE","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"","code":"tag_cells_in_ccc_graph(ccog, COIs, edges_expanded_to_group = FALSE)"},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"ccog CCC graph COIs array nodes highlight edges_expanded_to_group TRUE,","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tag_cells_in_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tag nodes if included in COIs — tag_cells_in_ccc_graph","text":"CCC graph InCOI tagged columns (see )","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"Tidy CCC graph removing isolated nodes","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"","code":"tidy_up_ccc_graph(ccog)"},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"ccog CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/tidy_up_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy up CCC graph by removing isolated nodes — tidy_up_ccc_graph","text":"CCC graph isolated nodes removed.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_barebone_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CCC table to barebone spatial CCC graph — to_barebone_spatial_ccc_graph","title":"Convert CCC table to barebone spatial CCC graph — to_barebone_spatial_ccc_graph","text":"Convert CCC table barebone spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_barebone_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CCC table to barebone spatial CCC graph — to_barebone_spatial_ccc_graph","text":"","code":"to_barebone_spatial_ccc_graph(ccc_table)"},{"path":"https://skimlab.github.io/spatialCCC/reference/to_barebone_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CCC table to barebone spatial CCC graph — to_barebone_spatial_ccc_graph","text":"ccc_table output compute_spatial_ccc()","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_barebone_spatial_ccc_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert CCC table to barebone spatial CCC graph — to_barebone_spatial_ccc_graph","text":"CCC graph (barebone)","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CCC table to spatial CCC graph — to_spatial_ccc_graph","title":"Convert CCC table to spatial CCC graph — to_spatial_ccc_graph","text":"Convert CCC table spatial CCC graph","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CCC table to spatial CCC graph — to_spatial_ccc_graph","text":"","code":"to_spatial_ccc_graph(ccc_table, spatial_data, LR_of_interest = NULL)"},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CCC table to spatial CCC graph — to_spatial_ccc_graph","text":"ccc_table output compute_spatial_ccc() spatial_data table spatial coordinates spots/cells spatial transcriptomic data.  spatial_data includes cell_id, spot_x, spot_y, used ; Otherwise, use first three columns cell_id, spot_x, spot_y LR_of_interest LR pair name string.  NULL (default), CCC graph created using LR pairs.","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a list of CCC tables to a list of spatial CCC graphs — to_spatial_ccc_graph_list","title":"Convert a list of CCC tables to a list of spatial CCC graphs — to_spatial_ccc_graph_list","text":"Convert list CCC tables list spatial CCC graphs","code":""},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a list of CCC tables to a list of spatial CCC graphs — to_spatial_ccc_graph_list","text":"","code":"to_spatial_ccc_graph_list(ccc_table, spatial_data, workers = 1)"},{"path":"https://skimlab.github.io/spatialCCC/reference/to_spatial_ccc_graph_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a list of CCC tables to a list of spatial CCC graphs — to_spatial_ccc_graph_list","text":"ccc_table output compute_spatial_ccc() spatial_data table spatial coordinates spots/cells spatial transcriptomic data.  spatial_data includes cell_id, spot_x, spot_y, used ; Otherwise, use first three columns cell_id, spot_x, spot_y workers number processes used parallel processing","code":""}]
